<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

    <title>Animal Shelter</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://localhost:8888/static/base/images/favicon.ico?v=97c6417ed01bdc0ae3ef32ae4894fd03">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="Animal%20Shelter_files/jquery-ui.css" type="text/css">
    <link rel="stylesheet" href="Animal%20Shelter_files/jquery.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="Animal%20Shelter_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="Animal%20Shelter_files/bootstrap-tour.css" type="text/css">
<link rel="stylesheet" href="Animal%20Shelter_files/codemirror.css">


    <link rel="stylesheet" href="Animal%20Shelter_files/style.css" type="text/css">
    

<link rel="stylesheet" href="Animal%20Shelter_files/override.css" type="text/css">
<link rel="stylesheet" href="" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="Animal%20Shelter_files/custom.css" type="text/css">
    <script src="Animal%20Shelter_files/promise.js" type="text/javascript" charset="utf-8"></script>
    <script src="Animal%20Shelter_files/index_003.js" type="text/javascript"></script>
    <script src="Animal%20Shelter_files/index.js" type="text/javascript"></script>
    <script src="Animal%20Shelter_files/index_002.js" type="text/javascript"></script>
    <script src="Animal%20Shelter_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20171217120552",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            'jquery-ui': 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/xterm.js/dist/xterm',
            typeahead: 'components/jquery-typeahead/dist/jquery.typeahead.min',
          },
          map: { // for backward compatibility
              "*": {
                  "jqueryui": "jquery-ui",
              }
          },
          shim: {
            typeahead: {
              deps: ["jquery"],
              exports: "typeahead"
            },
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            "jquery-ui": {
              deps: ["jquery"],
              exports: "$"
            }
          },
          waitSeconds: 30,
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });

      // error-catching custom.js shim.
      define("custom", function (require, exports, module) {
          try {
              var custom = require('custom/custom');
              console.debug('loaded custom.js');
              return custom;
          } catch (e) {
              console.error("error loading custom.js", e);
              return {};
          }
      })
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="Animal%20Shelter_files/contents.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="Animal%20Shelter_files/custom.js"></script><style type="text/css">div.MathJax_MathML {text-align: center; margin: .75em 0px; display: block!important}
.MathJax_MathML {font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
span.MathJax_MathML {display: inline!important}
.MathJax_mmlExBox {display: block!important; overflow: hidden; height: 1px; width: 60ex; min-height: 0; max-height: none; padding: 0; border: 0; margin: 0}
[class="MJX-tex-oldstyle"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-oldstyle-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
[class="MJX-tex-caligraphic"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB}
[class="MJX-tex-caligraphic-bold"] {font-family: MathJax_Caligraphic, MathJax_Caligraphic-WEB; font-weight: bold}
@font-face /*1*/ {font-family: MathJax_Caligraphic-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf')}
@font-face /*2*/ {font-family: MathJax_Caligraphic-WEB; font-weight: bold; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf')}
[mathvariant="double-struck"] {font-family: MathJax_AMS, MathJax_AMS-WEB}
[mathvariant="script"] {font-family: MathJax_Script, MathJax_Script-WEB}
[mathvariant="fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB}
[mathvariant="bold-script"] {font-family: MathJax_Script, MathJax_Caligraphic-WEB; font-weight: bold}
[mathvariant="bold-fraktur"] {font-family: MathJax_Fraktur, MathJax_Fraktur-WEB; font-weight: bold}
[mathvariant="monospace"] {font-family: monospace}
[mathvariant="sans-serif"] {font-family: sans-serif}
[mathvariant="bold-sans-serif"] {font-family: sans-serif; font-weight: bold}
[mathvariant="sans-serif-italic"] {font-family: sans-serif; font-style: italic}
[mathvariant="sans-serif-bold-italic"] {font-family: sans-serif; font-style: italic; font-weight: bold}
@font-face /*3*/ {font-family: MathJax_AMS-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf')}
@font-face /*4*/ {font-family: MathJax_Script-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf')}
@font-face /*5*/ {font-family: MathJax_Fraktur-WEB; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf')}
@font-face /*6*/ {font-family: MathJax_Fraktur-WEB; font-weight: bold; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf')}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="Animal%20Shelter_files/extension.html"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Italic.woff?rev=2.6.0') format('woff'), url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Italic.otf?rev=2.6.0') format('opentype'); font-style: italic}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Regular.woff?rev=2.6.0') format('woff'), url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Regular.otf?rev=2.6.0') format('opentype')}
</style><link id="favicon" type="image/x-icon" rel="shortcut icon" href="http://localhost:8888/static/base/images/favicon.ico"></head>

<body class="notebook_app edit_mode" data-jupyter-api-token="f54fc96fa8a3e6ac3cc1f3c3c2e5ea94f66fda1da336268f" data-base-url="/" data-ws-url="" data-notebook-name="Animal%20Shelter.ipynb" data-notebook-path="Assignment/Animal%20Shelter.ipynb" dir="ltr"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      Jupyter Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://localhost:8888/tree" title="dashboard"><img src="Animal%20Shelter_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
        <button id="logout" class="btn btn-sm navbar-btn">Logout</button>
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">Animal Shelter</span>
    <span class="checkpoint_status" title="Thu, Dec 28, 2017 6:53 PM">Last Checkpoint: 5 hours ago</span>
    <span class="autosave_status">(autosaved)</span>
</span>

<span id="kernel_logo_widget">
  
  <img class="current_kernel_logo" src="Animal%20Shelter_files/logo-64x64.png" title="Python 2" style="display: inline;">
  
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 2</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Edit Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div><div id="notification_trusted" class="notification_widget btn btn-xs navbar-btn" style="display: inline-block;"><span>Trusted</span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python2"><a href="#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook's contents and start a new kernel">
                            <a href="#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="#">Thursday, December 28, 2017 6:53 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="#">Download as</a>
                            <ul id="download_menu" class="dropdown-menu">
                                <li id="download_ipynb"><a href="#">Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="#">Python (.py)</a></li>
                                <li id="download_html"><a href="#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="#">reST (.rst)</a></li>
                                <li id="download_latex"><a href="#">LaTeX (.tex)</a></li>
                                <li id="download_pdf"><a href="#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="dropdown-submenu hidden"><a href="#">Deploy as</a>
                            <ul id="deploy_menu" class="dropdown-menu"></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook's kernel, and close this window">
                            <a href="#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="#">Cut Cells</a></li>
                        <li id="copy_cell"><a href="#">Copy Cells</a></li>
                        <li id="paste_cell_above" class="disabled"><a href="#">Paste Cells Above</a></li>
                        <li id="paste_cell_below" class="disabled"><a href="#">Paste Cells Below</a></li>
                        <li id="paste_cell_replace" class="disabled"><a href="#">Paste Cells &amp; Replace</a></li>
                        <li id="delete_cell"><a href="#">Delete Cells</a></li>
                        <li id="undelete_cell" class=""><a href="#">Undo Delete Cells</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="#">Edit Notebook Metadata</a></li>
                        <li class="divider"></li>
                        <li id="find_and_replace"><a href="#"> Find and Replace </a></li>
                        <li class="divider"></li>
                        <li id="cut_cell_attachments"><a href="#">Cut Cell Attachments</a></li>
                        <li id="copy_cell_attachments"><a href="#">Copy Cell Attachments</a></li>
                        <li id="paste_cell_attachments" class="disabled"><a href="#">Paste Cell Attachments</a></li>
                        <li class="divider"></li>
                        <li id="insert_image" class="disabled"><a href="#"> Insert Image </a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the logo and notebook title (above menu bar)">
                            <a href="#">Toggle Header</a>
                        </li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="#">Toggle Toolbar</a>
                        </li>
                        <li id="toggle_line_numbers" title="Show/Hide line numbers in cells">
                            <a href="#">Toggle Line Numbers</a>
                        </li>
                        <li id="menu-cell-toolbar" class="dropdown-submenu">
                            <a href="#">Cell Toolbar</a>
                            <ul class="dropdown-menu" id="menu-cell-toolbar-submenu"><li data-name="None"><a href="#">None</a></li><li data-name="Edit%20Metadata"><a href="#">Edit Metadata</a></li><li data-name="Raw%20Cell%20Format"><a href="#">Raw Cell Format</a></li><li data-name="Slideshow"><a href="#">Slideshow</a></li><li data-name="Attachments"><a href="#">Attachments</a></li><li data-name="Tags"><a href="#">Tags</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="#">Run Cells</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="#">Run Cells and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="#">Run Cells and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as 'Code' cells">
                            <a href="#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="#">Current Outputs</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="#">Restart</a>
                        </li>
                        <li id="restart_clear_output" title="Restart the Kernel and clear all output">
                            <a href="#">Restart &amp; Clear Output</a>
                        </li>
                        <li id="restart_run_all" title="Restart the Kernel and re-run the notebook">
                            <a href="#">Restart &amp; Run All</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="#">Reconnect</a>
                        </li>
                        <li id="shutdown_kernel" title="Shutdown the Kernel">
                            <a href="#">Shutdown</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="#">Python 2</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a dialog which shows all keyboard shortcuts"><a href="#">Keyboard Shortcuts</a></li>
                        <li id="edit_keyboard_shortcuts" title="Opens a dialog allowing you to edit Keyboard shortcuts"><a href="#">Edit Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a rel="noreferrer" href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a rel="noreferrer" href="https://help.github.com/articles/markdown-basics/" target="_blank" title="Opens in a new window">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/2.7?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/?v=20171217120552"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About Jupyter Notebook"><a id="notebook_about" href="#">About</a></li>
                        
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="jupyter-notebook:save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="jupyter-notebook:insert-cell-below"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cells" data-jupyter-action="jupyter-notebook:cut-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cells" data-jupyter-action="jupyter-notebook:copy-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cells below" data-jupyter-action="jupyter-notebook:paste-cell-below"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cells up" data-jupyter-action="jupyter-notebook:move-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cells down" data-jupyter-action="jupyter-notebook:move-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="jupyter-notebook:run-cell-and-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="jupyter-notebook:interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart the kernel (with dialog)" data-jupyter-action="jupyter-notebook:confirm-restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code" selected="selected">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option><option value="multiselect" disabled="disabled" style="display: none;">-</option></select><div class="btn-group"><button class="btn btn-default" title="open the command palette" data-jupyter-action="jupyter-notebook:show-command-palette"><i class="fa-keyboard-o fa"></i></button></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 835px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[14]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">import itertools
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import math
import random

from collections import Counter

from sklearn import preprocessing
from sklearn.linear_model import LogisticRegression
from sklearn.cross_validation import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.decomposition import TruncatedSVD
from sklearn.preprocessing import LabelEncoder
from sklearn.cross_validation import StratifiedKFold
from sklearn.feature_selection import RFECV
from sklearn.preprocessing import StandardScaler
from sklearn.preprocessing import scale

from sklearn.ensemble import RandomForestClassifier

from sklearn.metrics import recall_score
from sklearn.metrics import log_loss
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix

from scipy import sparse

from datetime import date, datetime</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 475px; margin-bottom: -10px; border-right-width: 20px; min-height: 538px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 510px; width: 280px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 984px; height: 493px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">itertools</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">seaborn</span> <span class="cm-keyword">as</span> <span class="cm-variable">sns</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">math</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">random</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">collections</span> <span class="cm-keyword">import</span> <span class="cm-variable">Counter</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span> <span class="cm-keyword">import</span> <span class="cm-variable">preprocessing</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">linear_model</span> <span class="cm-keyword">import</span> <span class="cm-variable">LogisticRegression</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">cross_validation</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">feature_extraction</span>.<span class="cm-property">text</span> <span class="cm-keyword">import</span> <span class="cm-variable">TfidfVectorizer</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">decomposition</span> <span class="cm-keyword">import</span> <span class="cm-variable">TruncatedSVD</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">LabelEncoder</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">cross_validation</span> <span class="cm-keyword">import</span> <span class="cm-variable">StratifiedKFold</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">feature_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">RFECV</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">StandardScaler</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">scale</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">ensemble</span> <span class="cm-keyword">import</span> <span class="cm-variable">RandomForestClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">recall_score</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">log_loss</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">classification_report</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">confusion_matrix</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">scipy</span> <span class="cm-keyword">import</span> <span class="cm-variable">sparse</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">datetime</span> <span class="cm-keyword">import</span> <span class="cm-variable">date</span>, <span class="cm-variable">datetime</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 538px;"></div><div class="CodeMirror-gutters" style="display: none; height: 558px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stderr"><pre>/usr/local/lib/python2.7/dist-packages/sklearn/cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[26]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.6px; left: 149.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 891px; margin-bottom: -10px; border-right-width: 20px; min-height: 1388px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 144px; top: 153px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># functions required to perform basic transformations</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># these transformations can be safely applied to all the data set (inc validation)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># because they only take into consideration the values of the current row</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># function to translate gender into </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_gender</span>(<span class="cm-variable">_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-string">'Female'</span> <span class="cm-keyword">in</span> <span class="cm-variable">_input</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">return</span> <span class="cm-string">'F'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">'Male'</span> <span class="cm-keyword">in</span> <span class="cm-variable">_input</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">return</span> <span class="cm-string">'M'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">return</span> <span class="cm-string">'U'</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># function that returns 1 if animal was operated; 0 otherwise</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">is_operated</span>(<span class="cm-variable">_input</span>):    </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-builtin">int</span>(<span class="cm-variable">_input</span>.<span class="cm-property">split</span>()[<span class="cm-number">0</span>] <span class="cm-keyword">in</span> [<span class="cm-string">'Neutered'</span>, <span class="cm-string">'Spayed'</span>])   </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># function that normalises age of animal in years</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_age_in_years</span>(<span class="cm-variable">_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">age</span> = <span class="cm-number">0.0</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">age_list</span> = <span class="cm-variable">_input</span>.<span class="cm-property">split</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-string">"year"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age</span> = <span class="cm-builtin">float</span>(<span class="cm-variable">age_list</span>[<span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">"month"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age</span> = <span class="cm-builtin">float</span>(<span class="cm-variable">age_list</span>[<span class="cm-number">0</span>]) <span class="cm-operator">/</span> <span class="cm-number">12.0</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">"week"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age</span> = <span class="cm-builtin">float</span>(<span class="cm-variable">age_list</span>[<span class="cm-number">0</span>]) <span class="cm-operator">/</span> <span class="cm-number">52.0</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># if less than 1 week, default to 1 week</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age</span> = <span class="cm-number">1.0</span> <span class="cm-operator">/</span> <span class="cm-number">52.0</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-builtin">round</span>(<span class="cm-variable">age</span>, <span class="cm-number">3</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Transform ages to categoris as follows:</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># 1 = neonatal; 2 = infant; 3 = child; 4 = adolescent; 5 = young_adult; 6 = mature_adult; 7 = old</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># These categories are based on rate that animal ages w.r.t. human years and the stages of human development</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># https://www.ajdesigner.com/fl_cat_age/cat_age.php; https://pets.webmd.com/dogs/how-to-calculate-your-dogs-age</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_age_in_labels</span>(<span class="cm-variable">_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">age_label</span> = <span class="cm-number">0</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">age_list</span> = <span class="cm-variable">_input</span>.<span class="cm-property">split</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">age</span> = <span class="cm-builtin">int</span>(<span class="cm-variable">age_list</span>[<span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-string">"year"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># </span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">options</span> = [<span class="cm-number">4</span>, <span class="cm-number">5</span>, <span class="cm-number">5</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">6</span>, <span class="cm-number">7</span>]</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age</span> = <span class="cm-variable">age</span> <span class="cm-operator">-</span> <span class="cm-number">1</span> <span class="cm-keyword">if</span> <span class="cm-variable">age</span> <span class="cm-operator">&lt;</span> <span class="cm-number">11</span> <span class="cm-keyword">else</span> <span class="cm-number">10</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age_label</span> = <span class="cm-variable">options</span>[<span class="cm-variable">age</span>]        </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">"month"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">options</span> = [<span class="cm-number">2</span>, <span class="cm-number">2</span>, <span class="cm-number">2</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>, <span class="cm-number">3</span>]</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age_label</span> = <span class="cm-variable">options</span>[<span class="cm-variable">age</span><span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">"week"</span> <span class="cm-keyword">in</span> <span class="cm-variable">age_list</span>[<span class="cm-number">1</span>]:        </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age_label</span> = <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># if less than 1 week, default to 1 week</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">age_label</span> = <span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-variable">age_label</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># this function returns purity category: "pure", "mixed", "cross"</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># depending on whether breed string features just the animal breed, the word "mix" or a fwd-slash</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_breed_purity</span>(<span class="cm-variable">_input</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">breed_purity</span> = <span class="cm-string">""</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-string">"/"</span> <span class="cm-keyword">in</span> <span class="cm-variable">_input</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">breed_purity</span> = <span class="cm-string">"cross"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">elif</span> <span class="cm-string">"Mix"</span> <span class="cm-keyword">in</span> <span class="cm-variable">_input</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">breed_purity</span> = <span class="cm-string">"mix"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">breed_purity</span> = <span class="cm-string">"pure"</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-variable">breed_purity</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># code to determine season from: https://stackoverflow.com/a/28688724</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">Y</span> = <span class="cm-number">2000</span> <span class="cm-comment"># dummy leap year to allow input X-02-29 (leap day)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">seasons</span> = [(<span class="cm-string">'winter'</span>, (<span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">1</span>,  <span class="cm-number">1</span>),  <span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">3</span>, <span class="cm-number">20</span>))),</span></pre><pre class=" CodeMirror-line "><span>           (<span class="cm-string">'spring'</span>, (<span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">3</span>, <span class="cm-number">21</span>),  <span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">6</span>, <span class="cm-number">20</span>))),</span></pre><pre class=" CodeMirror-line "><span>           (<span class="cm-string">'summer'</span>, (<span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">6</span>, <span class="cm-number">21</span>),  <span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">9</span>, <span class="cm-number">22</span>))),</span></pre><pre class=" CodeMirror-line "><span>           (<span class="cm-string">'autumn'</span>, (<span class="cm-variable">date</span>(<span class="cm-variable">Y</span>,  <span class="cm-number">9</span>, <span class="cm-number">23</span>),  <span class="cm-variable">date</span>(<span class="cm-variable">Y</span>, <span class="cm-number">12</span>, <span class="cm-number">20</span>))),</span></pre><pre class=" CodeMirror-line "><span>           (<span class="cm-string">'winter'</span>, (<span class="cm-variable">date</span>(<span class="cm-variable">Y</span>, <span class="cm-number">12</span>, <span class="cm-number">21</span>),  <span class="cm-variable">date</span>(<span class="cm-variable">Y</span>, <span class="cm-number">12</span>, <span class="cm-number">31</span>)))]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_season</span>(<span class="cm-variable">now</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-builtin">isinstance</span>(<span class="cm-variable">now</span>, <span class="cm-variable">datetime</span>):</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">now</span> = <span class="cm-variable">now</span>.<span class="cm-property">date</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">now</span> = <span class="cm-variable">now</span>.<span class="cm-property">replace</span>(<span class="cm-variable">year</span>=<span class="cm-variable">Y</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-builtin">next</span>(<span class="cm-variable">season</span> <span class="cm-keyword">for</span> <span class="cm-variable">season</span>, (<span class="cm-variable">start</span>, <span class="cm-variable">end</span>) <span class="cm-keyword">in</span> <span class="cm-variable">seasons</span></span></pre><pre class=" CodeMirror-line "><span>                <span class="cm-keyword">if</span> <span class="cm-variable">start</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">now</span> <span class="cm-operator">&lt;</span>= <span class="cm-variable">end</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 1388px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1408px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[36]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59985px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"># import training data in pandas dataframe df
df = pd.read_csv('train.csv', header=0, sep=",")</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 915px; margin-bottom: -10px; border-right-width: 20px; min-height: 351px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 384px; height: 17px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># import training data in pandas dataframe df</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">read_csv</span>(<span class="cm-string">'train.csv'</span>, <span class="cm-variable">header</span>=<span class="cm-number">0</span>, <span class="cm-variable">sep</span>=<span class="cm-string">","</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># print columns having at least one null entry</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print df.isnull().any()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># only 1 case of unknown sex</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-variable">df</span>[<span class="cm-string">"SexuponOutcome"</span>].<span class="cm-property">isnull</span>() == <span class="cm-builtin">True</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># only 18 cases of unknown age</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-builtin">len</span>(<span class="cm-variable">df</span>[<span class="cm-variable">df</span>[<span class="cm-string">"AgeuponOutcome"</span>].<span class="cm-property">isnull</span>() == <span class="cm-builtin">True</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># remove null cases </span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># remove null ages</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span> = <span class="cm-variable">df</span>[<span class="cm-operator">~</span><span class="cm-variable">df</span>[<span class="cm-string">'AgeuponOutcome'</span>].<span class="cm-property">isnull</span>()]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span> = <span class="cm-variable">df</span>[<span class="cm-operator">~</span><span class="cm-variable">df</span>[<span class="cm-string">'SexuponOutcome'</span>].<span class="cm-property">isnull</span>()]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print df.isnull().any()</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># there are 22 cases where Age is 0 years; the distribution of outcomes (compared to the cases where age is known)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># strongly suggests that these animals are neonatal.  Defaulting the value to 1 week</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">df</span>[(<span class="cm-variable">df</span>.<span class="cm-property">AgeuponOutcome</span> == <span class="cm-string">'0 years'</span>)][<span class="cm-string">"OutcomeType"</span>].<span class="cm-property">value_counts</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>.<span class="cm-property">loc</span>[<span class="cm-variable">df</span>.<span class="cm-property">AgeuponOutcome</span> == <span class="cm-string">'0 years'</span>, <span class="cm-string">'AgeuponOutcome'</span>] = <span class="cm-string">"1 week"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 351px;"></div><div class="CodeMirror-gutters" style="display: none; height: 371px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Transfer      19
Euthanasia     2
Died           1
Name: OutcomeType, dtype: int64
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[37]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 226.6px; left: 909.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">pd.get_dummies(df, columns=['AnimalType', 'Gender', 'BreedPurity', 'Season','AgeCategory'], drop_first=True)</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 907px; margin-bottom: -10px; border-right-width: 20px; min-height: 368px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 40px; top: 221px; width: 864px; height: 17px;"></div></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># we are going to perform dummy converstion, label encoding prior to splitting</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># replace missing value with "Unknown"</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"HasName"</span>] = (<span class="cm-operator">~</span><span class="cm-variable">df</span>.<span class="cm-property">loc</span>[:,<span class="cm-string">"Name"</span>].<span class="cm-property">isnull</span>()).<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">int</span>(<span class="cm-variable">x</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"IsOperated"</span>] = <span class="cm-variable">df</span>[<span class="cm-string">"SexuponOutcome"</span>].<span class="cm-property">apply</span>(<span class="cm-variable">is_operated</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"Gender"</span>] = <span class="cm-variable">df</span>[<span class="cm-string">"SexuponOutcome"</span>].<span class="cm-property">apply</span>(<span class="cm-variable">get_gender</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"AgeCategory"</span>] = <span class="cm-variable">df</span>[<span class="cm-string">"AgeuponOutcome"</span>].<span class="cm-property">apply</span>(<span class="cm-variable">get_age_in_labels</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"BreedPurity"</span>] = <span class="cm-variable">df</span>[<span class="cm-string">"Breed"</span>].<span class="cm-property">apply</span>(<span class="cm-variable">get_breed_purity</span>).<span class="cm-property">astype</span>(<span class="cm-string">'category'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"IsWeekend"</span>] = <span class="cm-variable">pd</span>.<span class="cm-property">to_datetime</span>(<span class="cm-variable">df</span>.<span class="cm-property">DateTime</span>).<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-builtin">int</span>(<span class="cm-number">1</span>  <span class="cm-keyword">if</span> <span class="cm-variable">x</span>.<span class="cm-property">weekday</span>() <span class="cm-keyword">in</span> [<span class="cm-number">5</span>,<span class="cm-number">6</span>] <span class="cm-keyword">else</span> <span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span>[<span class="cm-string">"Season"</span>] = <span class="cm-variable">pd</span>.<span class="cm-property">to_datetime</span>(<span class="cm-variable">df</span>.<span class="cm-property">DateTime</span>).<span class="cm-property">apply</span>(<span class="cm-variable">get_season</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df = df.assign(AgeCategory = scale(df.AgeuponOutcome.apply(get_age_in_years)))#.drop(["AgeuponOutcome"], axis=1)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df["Month"] = pd.to_datetime(df.DateTime).apply(lambda x: x.strftime("%b"))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">get_dummies</span>(<span class="cm-variable">df</span>, <span class="cm-variable">columns</span>=[<span class="cm-string">'AnimalType'</span>, <span class="cm-string">'Gender'</span>, <span class="cm-string">'BreedPurity'</span>, <span class="cm-string">'Season'</span>,<span class="cm-string">'AgeCategory'</span>], <span class="cm-variable">drop_first</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df = pd.get_dummies(df, columns=['AnimalType', 'Gender', 'BreedPurity', 'Season'], drop_first=True)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df = pd.get_dummies(df, columns=['OutcomeType'])</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># features that will be used to build our model</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># HasName, AnimalType_Dog, Gender, is_operated, </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># lets start with a simple model that ignores the breed and color</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># we will then build a more complex model that features TFID terms </span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 368px;"></div><div class="CodeMirror-gutters" style="display: none; height: 388px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[38]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 229.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 339px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 224px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># Display columns to make selection easier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ids</span> = <span class="cm-builtin">range</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">df</span>.<span class="cm-property">columns</span>))</span></pre><pre class=" CodeMirror-line "><span>[(<span class="cm-variable">x</span>, <span class="cm-variable">df</span>.<span class="cm-property">columns</span>[<span class="cm-variable">x</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">ids</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[38]:</div><div class="output_subarea output_text output_result"><pre>[(0, 'AnimalID'),
 (1, 'Name'),
 (2, 'DateTime'),
 (3, 'OutcomeType'),
 (4, 'OutcomeSubtype'),
 (5, 'SexuponOutcome'),
 (6, 'AgeuponOutcome'),
 (7, 'Breed'),
 (8, 'Color'),
 (9, 'HasName'),
 (10, 'IsOperated'),
 (11, 'IsWeekend'),
 (12, 'AnimalType_Dog'),
 (13, 'Gender_M'),
 (14, 'Gender_U'),
 (15, 'BreedPurity_mix'),
 (16, 'BreedPurity_pure'),
 (17, 'Season_spring'),
 (18, 'Season_summer'),
 (19, 'Season_winter'),
 (20, 'AgeCategory_2'),
 (21, 'AgeCategory_3'),
 (22, 'AgeCategory_4'),
 (23, 'AgeCategory_5'),
 (24, 'AgeCategory_6'),
 (25, 'AgeCategory_7')]</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[40]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 467px; margin-bottom: -10px; border-right-width: 20px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># retain model column names</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">model_columns</span> = <span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[:,<span class="cm-number">9</span>:<span class="cm-number">26</span>].<span class="cm-property">columns</span>.<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># if age category is continuous</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#model_columns = df.iloc[:,9:21].columns.values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#model_columns = df.iloc[:,[9,10,11,12,13]].columns.values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">model_columns</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df.loc[:,"AgeCategory"]</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 201px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[40]:</div><div class="output_subarea output_text output_result"><pre>array(['HasName', 'IsOperated', 'IsWeekend', 'AnimalType_Dog', 'Gender_M',
       'Gender_U', 'BreedPurity_mix', 'BreedPurity_pure', 'Season_spring',
       'Season_summer', 'Season_winter', 'AgeCategory_2', 'AgeCategory_3',
       'AgeCategory_4', 'AgeCategory_5', 'AgeCategory_6', 'AgeCategory_7'], dtype=object)</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered selected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 209.6px; left: 205.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 707px; margin-bottom: -10px; border-right-width: 20px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 200px; top: 204px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># create feature and label array (when not using tfidx features)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X</span> = <span class="cm-variable">df</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X = StandardScaler(with_mean=False).fit_transform(X)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y</span> = <span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># uncomment the below to train ensemble of 1vsrest Logistic Classifiers</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#y = df.iloc[:, 20:].values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># we can compute inverse_transform to get back the labels</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># le.inverse_transform</span><span class="cm-comment CodeMirror-matchingbracket">(</span><span class="cm-comment">y</span><span class="cm-comment CodeMirror-matchingbracket">)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># split in training and testing sets</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">X</span>, <span class="cm-variable">y</span>, <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 303px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 464.6px; left: 277.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1075px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1075px; margin-bottom: -10px; border-right-width: 20px; min-height: 929px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 272px; top: 459px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">decomposition</span> <span class="cm-keyword">import</span> <span class="cm-variable">TruncatedSVD</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># was max_df 0.1</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># now let's create the tfidf features</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df_train</span>, <span class="cm-variable">df_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">df</span>, <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tfv</span> = <span class="cm-variable">TfidfVectorizer</span>(<span class="cm-variable">min_df</span>=<span class="cm-number">0.0025</span>, <span class="cm-variable">max_df</span>=<span class="cm-number">0.5</span>, <span class="cm-variable">max_features</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">strip_accents</span>=<span class="cm-string">'unicode'</span>, <span class="cm-variable">analyzer</span>=<span class="cm-string">'word'</span>, <span class="cm-variable">token_pattern</span>=<span class="cm-string">r'\w{1,}'</span>,</span></pre><pre class=" CodeMirror-line "><span>                     <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>,<span class="cm-number">2</span>), <span class="cm-variable">use_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">smooth_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">sublinear_tf</span>=<span class="cm-number">1</span>, <span class="cm-variable">stop_words</span>=<span class="cm-string">'english'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_train</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span> = <span class="cm-variable">tfv</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">breed_colour</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_top_n_features</span>(<span class="cm-variable">tfidf_array</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">weights</span> = <span class="cm-variable">tfidf_array</span>.<span class="cm-property">mean</span>(<span class="cm-variable">axis</span>=<span class="cm-number">0</span>).<span class="cm-property">ravel</span>().<span class="cm-property">tolist</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">weights_df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>({<span class="cm-string">'term'</span>: <span class="cm-variable">tfv</span>.<span class="cm-property">get_feature_names</span>(), <span class="cm-string">'weight'</span>:<span class="cm-variable">weights</span>})</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span> <span class="cm-variable">weights_df</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-string">'weight'</span>, <span class="cm-variable">ascending</span>=<span class="cm-builtin">False</span>).<span class="cm-property">head</span>(<span class="cm-number">20</span>)    </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#weights = np.asarray(breed_colour.mean(axis=0)).ravel().tolist()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#weights_df = pd.DataFrame({'term': tfv.get_feature_names(), 'weight':weights})</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print weights_df.sort_values(by='weight', ascending=False).head(20)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># perform dimensionality reduction using SVD</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#svd = TruncatedSVD(n_components=100)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#breed_colour_svd = svd.fit_transform(breed_colour)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span> = <span class="cm-variable">df_train</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_train = sparse.hstack((X_train, breed_colour))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_train</span>, <span class="cm-variable">breed_colour</span>.<span class="cm-property">toarray</span>()))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_train = np.hstack((X_train, breed_colour_svd))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">##ss = StandardScaler(with_mean=False)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#ss = StandardScaler()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_train = ss.fit_transform(X_train)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_test</span> = <span class="cm-variable">df_test</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour_test</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_test</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour_test</span> = <span class="cm-variable">tfv</span>.<span class="cm-property">transform</span>(<span class="cm-variable">breed_colour_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#breed_colour_test_svd = svd.transform(breed_colour_test)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_test</span>, <span class="cm-variable">breed_colour_test</span>.<span class="cm-property">toarray</span>()))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = sparse.hstack((X_test, breed_colour_test))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = np.hstack((X_test, breed_colour_test_svd))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = ss.transform(X_test)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_train</span> = <span class="cm-variable">df_train</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_test</span> = <span class="cm-variable">df_test</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_train</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_test</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">arrays</span> = [<span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-variable">x</span>.<span class="cm-property">shape</span> <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">arrays</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 929px;"></div><div class="CodeMirror-gutters" style="display: none; height: 959px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">extended_model_columns = np.hstack((model_columns, tfv.get_feature_names()) )</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 619px; margin-bottom: -10px; border-right-width: 20px; min-height: 28px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 616px; height: 17px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">extended_model_columns</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">model_columns</span>, <span class="cm-variable">tfv</span>.<span class="cm-property">get_feature_names</span>()) )</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 28px;"></div><div class="CodeMirror-gutters" style="display: none; height: 48px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">get_top_n_features((X_train[y_train==3])[:,17:])</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 387px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 384px; height: 17px;"></div></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># get top features associated with outcome</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">get_top_n_features</span>((<span class="cm-variable">X_train</span>[<span class="cm-variable">y_train</span>==<span class="cm-number">3</span>])[:,<span class="cm-number">17</span>:])</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"># Check label proportions
from collections import Counter
_foo = Counter(y_test), Counter(y_train)
print _foo
# confirm that propotion of test outcome is similar to population proportion
print [round(float(_foo[0][x]) / sum(_foo[0].values()),3)   for x in _foo[0]]

# confirm that propotion of train outcome is similar to population proportion
print [round(float(_foo[1][x]) / sum(_foo[1].values()),3)   for x in _foo[1]]</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 619px; margin-bottom: -10px; border-right-width: 20px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 136px; width: 616px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 984px; height: 119px;"></div></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Check label proportions</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">collections</span> <span class="cm-keyword">import</span> <span class="cm-variable">Counter</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">_foo</span> = <span class="cm-variable">Counter</span>(<span class="cm-variable">y_test</span>), <span class="cm-variable">Counter</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">_foo</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># confirm that propotion of test outcome is similar to population proportion</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-builtin">round</span>(<span class="cm-builtin">float</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">0</span>][<span class="cm-variable">x</span>]) <span class="cm-operator">/</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span>()),<span class="cm-number">3</span>)   <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">_foo</span>[<span class="cm-number">0</span>]]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># confirm that propotion of train outcome is similar to population proportion</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-builtin">round</span>(<span class="cm-builtin">float</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">1</span>][<span class="cm-variable">x</span>]) <span class="cm-operator">/</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">1</span>].<span class="cm-property">values</span>()),<span class="cm-number">3</span>)   <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">_foo</span>[<span class="cm-number">1</span>]]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Random Forest Classification</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Random-Forest-Classification">Random Forest Classification<a class="anchor-link" href="#Random-Forest-Classification">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 333.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 731px; margin-bottom: -10px; border-right-width: 20px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 328px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">forest</span> = <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">n_estimators</span>=<span class="cm-number">1000</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">0</span>, <span class="cm-variable">class_weight</span>=<span class="cm-string">'balanced'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">forest</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">importances</span> = <span class="cm-variable">forest</span>.<span class="cm-property">feature_importances_</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">indices</span> = <span class="cm-variable">np</span>.<span class="cm-property">argsort</span>(<span class="cm-variable">importances</span>)[::<span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 99px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 357.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 779px; margin-bottom: -10px; border-right-width: 20px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 352px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">f</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">X_train</span>.<span class="cm-property">shape</span>[<span class="cm-number">1</span>]):</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#for f in range(25):</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span> <span class="cm-string">"%2d) %-*s %f"</span> <span class="cm-operator">%</span> (<span class="cm-variable">f</span><span class="cm-operator">+</span><span class="cm-number">1</span>, <span class="cm-number">30</span>, <span class="cm-variable">extended_model_columns</span>[<span class="cm-variable">indices</span>[<span class="cm-variable">f</span>]], <span class="cm-variable">importances</span>[<span class="cm-variable">indices</span>[<span class="cm-variable">f</span>]])</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#prediction = forest.predict_proba(X_test)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction</span> = <span class="cm-variable">forest</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction_prob</span> = <span class="cm-variable">forest</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 150px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 93.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 88px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span>print len(range(25))</span></pre><pre class=" CodeMirror-line "><span>print len(indices[0:25])</span></pre><pre class=" CodeMirror-line "><span>le.classes<span class="cm-em">_</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Type <em>Markdown</em> and LaTeX: <span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" role="math" style="width: 1.25em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.985em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.436em, 1000.99em, 2.657em, -1000em); top: -2.462em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="msubsup" id="MathJax-Span-3"><span style="display: inline-block; position: relative; width: 0.981em; height: 0px;"><span style="position: absolute; clip: rect(3.374em, 1000.55em, 4.196em, -1000em); top: -4em; left: 0em;"><span class="mi" id="MathJax-Span-4" style="font-family: STIXMathJax_Main; font-style: italic;">α</span><span style="display: inline-block; width: 0px; height: 4em;"></span></span><span style="position: absolute; top: -4.363em; left: 0.552em;"><span class="mn" id="MathJax-Span-5" style="font-size: 70.7%; font-family: STIXMathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 4em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.462em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 1.219em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>α</mi><mn>2</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-1">\alpha^2</script></p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 461.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 851px; margin-bottom: -10px; border-right-width: 20px; min-height: 249px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 456px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#print(classification_report(y_test, prediction, target_names=le.classes_))</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">plot_feature_importance</span>(<span class="cm-variable">importances</span>, <span class="cm-variable">indices</span>, <span class="cm-variable">feature_count</span>, <span class="cm-variable">extended_model_columns</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">title</span>(<span class="cm-string">'Feature Importance'</span>)    </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">bar</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">feature_count</span>),<span class="cm-variable">importances</span>[<span class="cm-variable">indices</span>[<span class="cm-number">0</span>:<span class="cm-variable">feature_count</span>]], <span class="cm-variable">color</span>=<span class="cm-string">'lightblue'</span>, <span class="cm-variable">align</span>=<span class="cm-string">'center'</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">xticks</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">feature_count</span>), <span class="cm-variable">extended_model_columns</span>[<span class="cm-variable">indices</span>[<span class="cm-number">0</span>:<span class="cm-variable">feature_count</span>]], <span class="cm-variable">rotation</span> = <span class="cm-number">90</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">xlim</span>([<span class="cm-operator">-</span><span class="cm-number">1</span>, <span class="cm-variable">feature_count</span>])</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">tight_layout</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">fig</span> = <span class="cm-variable">plt</span>.<span class="cm-property">figure</span>(<span class="cm-variable">figsize</span>=(<span class="cm-number">20</span>, <span class="cm-number">10</span>))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">close</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 249px;"></div><div class="CodeMirror-gutters" style="display: none; height: 269px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[53]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.6px; left: 509.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1443px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1443px; margin-bottom: -10px; border-right-width: 20px; min-height: 759px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 504px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># plot confusion matrix from http://scikit-learn.org/stable/auto_examples/model_selection/plot_confusion_matrix.html#sphx-glr-auto-examples-model-selection-plot-confusion-matrix-py</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">plot_confusion_matrix</span>(<span class="cm-variable">cm</span>, <span class="cm-variable">classes</span>,</span></pre><pre class=" CodeMirror-line "><span>                          <span class="cm-variable">normalize</span>=<span class="cm-builtin">False</span>,</span></pre><pre class=" CodeMirror-line "><span>                          <span class="cm-variable">title</span>=<span class="cm-string">'Confusion matrix'</span>,</span></pre><pre class=" CodeMirror-line "><span>                          <span class="cm-variable">cmap</span>=<span class="cm-variable">plt</span>.<span class="cm-property">cm</span>.<span class="cm-property">Blues</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-string">    This function prints and plots the confusion matrix.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-string">    Normalization can be applied by setting `normalize=True`.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-string">    """</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">if</span> <span class="cm-variable">normalize</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">cm</span> = <span class="cm-variable">cm</span>.<span class="cm-property">astype</span>(<span class="cm-string">'float'</span>) <span class="cm-operator">/</span> <span class="cm-variable">cm</span>.<span class="cm-property">sum</span>(<span class="cm-variable">axis</span>=<span class="cm-number">1</span>)[:, <span class="cm-variable">np</span>.<span class="cm-property">newaxis</span>]</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">print</span>(<span class="cm-string">"Normalized confusion matrix"</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-keyword">print</span>(<span class="cm-string">'Confusion matrix, without normalization'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span>(<span class="cm-variable">cm</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">imshow</span>(<span class="cm-variable">cm</span>, <span class="cm-variable">interpolation</span>=<span class="cm-string">'nearest'</span>, <span class="cm-variable">cmap</span>=<span class="cm-variable">cmap</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">title</span>(<span class="cm-variable">title</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">colorbar</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">tick_marks</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">classes</span>))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">xticks</span>(<span class="cm-variable">tick_marks</span>, <span class="cm-variable">classes</span>, <span class="cm-variable">rotation</span>=<span class="cm-number">45</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">yticks</span>(<span class="cm-variable">tick_marks</span>, <span class="cm-variable">classes</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">fmt</span> = <span class="cm-string">'.2f'</span> <span class="cm-keyword">if</span> <span class="cm-variable">normalize</span> <span class="cm-keyword">else</span> <span class="cm-string">'d'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">thresh</span> = <span class="cm-variable">cm</span>.<span class="cm-property">max</span>() <span class="cm-operator">/</span> <span class="cm-number">2.</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">for</span> <span class="cm-variable">i</span>, <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-variable">itertools</span>.<span class="cm-property">product</span>(<span class="cm-builtin">range</span>(<span class="cm-variable">cm</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>]), <span class="cm-builtin">range</span>(<span class="cm-variable">cm</span>.<span class="cm-property">shape</span>[<span class="cm-number">1</span>])):</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">text</span>(<span class="cm-variable">j</span>, <span class="cm-variable">i</span>, <span class="cm-builtin">format</span>(<span class="cm-variable">cm</span>[<span class="cm-variable">i</span>, <span class="cm-variable">j</span>], <span class="cm-variable">fmt</span>),</span></pre><pre class=" CodeMirror-line "><span>                 <span class="cm-variable">horizontalalignment</span>=<span class="cm-string">"center"</span>,</span></pre><pre class=" CodeMirror-line "><span>                 <span class="cm-variable">color</span>=<span class="cm-string">"white"</span> <span class="cm-keyword">if</span> <span class="cm-variable">cm</span>[<span class="cm-variable">i</span>, <span class="cm-variable">j</span>] <span class="cm-operator">&gt;</span> <span class="cm-variable">thresh</span> <span class="cm-keyword">else</span> <span class="cm-string">"black"</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">tight_layout</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">ylabel</span>(<span class="cm-string">'True label'</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'Predicted label'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#cnm = confusion_matrix(y_test, prediction)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#plt.figure()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#plot_confusion_matrix(cnm, classes=le.classes_, title='Confusion matrix, without normalization')</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#plt.show()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#plt.close()</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 759px;"></div><div class="CodeMirror-gutters" style="display: none; height: 789px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Dogs vs Cats</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Dogs-vs-Cats">Dogs vs Cats<a class="anchor-link" href="#Dogs-vs-Cats">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 141.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 899px; margin-bottom: -10px; border-right-width: 20px; min-height: 300px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 136px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Random Forest Classification based on dogs and cats separately</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># create feature and label array (when not using tfidx features)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog</span> = <span class="cm-variable">df</span>.<span class="cm-property">loc</span>[<span class="cm-variable">df</span>.<span class="cm-property">AnimalType_Dog</span> == <span class="cm-number">0</span>, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X = StandardScaler(with_mean=False).fit_transform(X)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog</span> = <span class="cm-variable">df</span>.<span class="cm-property">loc</span>[<span class="cm-variable">df</span>.<span class="cm-property">AnimalType_Dog</span> == <span class="cm-number">0</span>, <span class="cm-string">"OutcomeType"</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># uncomment the below to train ensemble of 1vsrest Logistic Classifiers</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#y = df.iloc[:, 20:].values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_dog</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># we can compute inverse_transform to get back the labels</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># le.inverse_transform(y)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># split in training and testing sets</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_train</span>, <span class="cm-variable">X_dog_test</span>, <span class="cm-variable">y_dog_train</span>, <span class="cm-variable">y_dog_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">X_dog</span>, <span class="cm-variable">y_dog</span>, <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 320px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unrendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 803px; margin-bottom: -10px; border-right-width: 20px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 68px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#forest_of_dogs = RandomForestClassifier(n_estimators=1000, random_state=0, class_weight='balanced')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">forest_of_dogs</span> = <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">n_estimators</span>=<span class="cm-number">1000</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">forest_of_dogs</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_dog_train</span>, <span class="cm-variable">y_dog_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#importances = forest.feature_importances_</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#indices = np.argsort(importances)[::-1]</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 116px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unrendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 659px; margin-bottom: -10px; border-right-width: 20px; min-height: 79px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># predict outcome based on test dogs</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction_dog</span> = <span class="cm-variable">forest_of_dogs</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_dog_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction_dog_prob</span> = <span class="cm-variable">forest_of_dogs</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_dog_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span>(<span class="cm-variable">classification_report</span>(<span class="cm-variable">y_dog_test</span>, <span class="cm-variable">prediction_dog</span>, <span class="cm-variable">target_names</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>))</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 79px;"></div><div class="CodeMirror-gutters" style="display: none; height: 99px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell unrendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 277.6px; left: 181.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">get_top_n_features</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1083px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1083px; margin-bottom: -10px; border-right-width: 20px; min-height: 844px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 32px; top: 272px; width: 144px; height: 17px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># was max_df 0.1</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># now let's create the tfidf features</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df_dog_train</span>, <span class="cm-variable">df_dog_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">df</span>[<span class="cm-variable">df</span>.<span class="cm-property">AnimalType_Dog</span> == <span class="cm-number">0</span>], <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#tfv = TfidfVectorizer(min_df=0.0025, max_df=0.5, max_features=None, strip_accents='unicode', analyzer='word', token_pattern=r'\w{1,}',</span></span></pre><pre class=" CodeMirror-line "><span> <span class="cm-comment">#                    ngram_range=(1,2), use_idf=1, smooth_idf=1, sublinear_tf=1, stop_words='english')</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tfv</span> = <span class="cm-variable">TfidfVectorizer</span>(<span class="cm-variable">min_df</span>=<span class="cm-number">3</span>, <span class="cm-variable">max_features</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">strip_accents</span>=<span class="cm-string">'unicode'</span>, <span class="cm-variable">analyzer</span>=<span class="cm-string">'word'</span>, <span class="cm-variable">token_pattern</span>=<span class="cm-string">r'\w{1,}'</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>,<span class="cm-number">2</span>), <span class="cm-variable">use_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">smooth_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">sublinear_tf</span>=<span class="cm-number">1</span>, <span class="cm-variable">stop_words</span>=<span class="cm-string">'english'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_dog_train</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span> = <span class="cm-variable">tfv</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">breed_colour</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour</span>.<span class="cm-property">shape</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_top_n_features</span>(<span class="cm-variable">tfidf_array</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">weights</span> = <span class="cm-variable">tfidf_array</span>.<span class="cm-property">mean</span>(<span class="cm-variable">axis</span>=<span class="cm-number">0</span>).<span class="cm-property">ravel</span>().<span class="cm-property">tolist</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">weights_df</span> = <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>({<span class="cm-string">'term'</span>: <span class="cm-variable">tfv</span>.<span class="cm-property">get_feature_names</span>(), <span class="cm-string">'weight'</span>:<span class="cm-variable">weights</span>})</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span> <span class="cm-variable">weights_df</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span>=<span class="cm-string">'weight'</span>, <span class="cm-variable">ascending</span>=<span class="cm-builtin">False</span>).<span class="cm-property">head</span>(<span class="cm-number">20</span>)    </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># perform dimensionality reduction using SVD</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#svd = TruncatedSVD(n_components=100)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#breed_colour_svd = svd.fit_transform(breed_colour)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_train</span> = <span class="cm-variable">df_dog_train</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_train = sparse.hstack((X_train, breed_colour))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_dog_train</span>, <span class="cm-variable">breed_colour</span>.<span class="cm-property">toarray</span>()))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_test</span> = <span class="cm-variable">df_dog_test</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour_test</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_dog_test</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">breed_colour_test</span> = <span class="cm-variable">tfv</span>.<span class="cm-property">transform</span>(<span class="cm-variable">breed_colour_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#breed_colour_test_svd = svd.transform(breed_colour_test)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_dog_test</span>, <span class="cm-variable">breed_colour_test</span>.<span class="cm-property">toarray</span>()))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = sparse.hstack((X_test, breed_colour_test))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = np.hstack((X_test, breed_colour_test_svd))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X_test = ss.transform(X_test)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_train</span> = <span class="cm-variable">df_dog_train</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_test</span> = <span class="cm-variable">df_dog_test</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_train</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_dog_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_test</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_dog_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">arrays</span> = [<span class="cm-variable">X_dog_train</span>, <span class="cm-variable">X_dog_test</span>, <span class="cm-variable">y_dog_train</span>, <span class="cm-variable">y_dog_test</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-variable">x</span>.<span class="cm-property">shape</span> <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">arrays</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 844px;"></div><div class="CodeMirror-gutters" style="display: none; height: 874px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[42]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.6px; left: 117.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1107px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1107px; margin-bottom: -10px; border-right-width: 20px; min-height: 147px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 112px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">create_vectoriser</span>():</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">tfd</span> = <span class="cm-variable">TfidfVectorizer</span>(<span class="cm-variable">min_df</span>=<span class="cm-number">0.0025</span>, <span class="cm-variable">max_df</span>=<span class="cm-number">0.5</span>, <span class="cm-variable">max_features</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">strip_accents</span>=<span class="cm-string">'unicode'</span>, <span class="cm-variable">analyzer</span>=<span class="cm-string">'word'</span>, <span class="cm-variable">token_pattern</span>=<span class="cm-string">r'\w{1,}'</span>,</span></pre><pre class=" CodeMirror-line "><span>                     <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>,<span class="cm-number">2</span>), <span class="cm-variable">use_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">smooth_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">sublinear_tf</span>=<span class="cm-number">1</span>, <span class="cm-variable">stop_words</span>=<span class="cm-string">'english'</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-variable">tfd</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">get_features</span>(<span class="cm-variable">df</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">text_features</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df</span>.<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-variable">text_features</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 147px;"></div><div class="CodeMirror-gutters" style="display: none; height: 177px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59999px; left: 635.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 630px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Create SVD for cat/dog textual features separately</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Create-SVD-for-cat/dog-textual-features-separately">Create SVD for cat/dog textual features separately<a class="anchor-link" href="#Create-SVD-for-cat/dog-textual-features-separately">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[46]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 974.6px; left: 469.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1099px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1099px; margin-bottom: -10px; border-right-width: 20px; min-height: 1677px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 464px; top: 969px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Reduce breed/colour dimensionality using SVD, retain 10 components only</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Since breed/colour for dogs are markedly different than from cats, we create two vectorisers and SVD transformers</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># The dog and cat components are reduced separately and then re-composed back to one training set.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">decomposition</span> <span class="cm-keyword">import</span> <span class="cm-variable">TruncatedSVD</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">df_train</span>, <span class="cm-variable">df_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">df</span>, <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#tfv_d = TfidfVectorizer(min_df=0.0025, max_df=0.5, max_features=None, strip_accents='unicode', analyzer='word', token_pattern=r'\w{1,}',</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#                     ngram_range=(1,2), use_idf=1, smooth_idf=1, sublinear_tf=1, stop_words='english')</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#tfv_c = TfidfVectorizer(min_df=0.0025, max_df=0.5, max_features=None, strip_accents='unicode', analyzer='word', token_pattern=r'\w{1,}',</span></span></pre><pre class=" CodeMirror-line "><span> <span class="cm-comment">#                    ngram_range=(1,2), use_idf=1, smooth_idf=1, sublinear_tf=1, stop_words='english')</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tfv_d</span> = <span class="cm-variable">TfidfVectorizer</span>(<span class="cm-variable">min_df</span>=<span class="cm-number">3</span>, <span class="cm-variable">max_features</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">strip_accents</span>=<span class="cm-string">'unicode'</span>, <span class="cm-variable">analyzer</span>=<span class="cm-string">'word'</span>, <span class="cm-variable">token_pattern</span>=<span class="cm-string">r'\w{1,}'</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>,<span class="cm-number">2</span>), <span class="cm-variable">use_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">smooth_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">sublinear_tf</span>=<span class="cm-number">1</span>, <span class="cm-variable">stop_words</span>=<span class="cm-string">'english'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">tfv_c</span> = <span class="cm-variable">TfidfVectorizer</span>(<span class="cm-variable">min_df</span>=<span class="cm-number">3</span>, <span class="cm-variable">max_features</span>=<span class="cm-builtin">None</span>, <span class="cm-variable">strip_accents</span>=<span class="cm-string">'unicode'</span>, <span class="cm-variable">analyzer</span>=<span class="cm-string">'word'</span>, <span class="cm-variable">token_pattern</span>=<span class="cm-string">r'\w{1,}'</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">ngram_range</span>=(<span class="cm-number">1</span>,<span class="cm-number">2</span>), <span class="cm-variable">use_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">smooth_idf</span>=<span class="cm-number">1</span>, <span class="cm-variable">sublinear_tf</span>=<span class="cm-number">1</span>, <span class="cm-variable">stop_words</span>=<span class="cm-string">'english'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#dog_text_features = list(df_train[df_train.AnimalType_Dog==1].apply(lambda x: '%s %s' % (x['Breed'], x['Color']),axis=1))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_text_features</span> = <span class="cm-variable">get_features</span>(<span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_text_features</span> = <span class="cm-variable">tfv_d</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">dog_text_features</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#cat_text_features = list(df_train[df_train.AnimalType_Dog==0] .apply(lambda x: '%s %s' % (x['Breed'], x['Color']),axis=1))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_text_features</span> = <span class="cm-variable">get_features</span>(<span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_text_features</span> = <span class="cm-variable">tfv_c</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">cat_text_features</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_svd</span> = <span class="cm-variable">TruncatedSVD</span>(<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_svd</span> = <span class="cm-variable">TruncatedSVD</span>(<span class="cm-number">10</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_tfdid_svd</span> = <span class="cm-variable">dog_svd</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">dog_text_features</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_tfdid_svd</span> = <span class="cm-variable">cat_svd</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">cat_text_features</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_scaler</span> = <span class="cm-variable">MinMaxScaler</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_scaler</span> = <span class="cm-variable">MinMaxScaler</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">minmax_dog_scale</span> = <span class="cm-variable">dog_scaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">dog_tfdid_svd</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">minmax_cat_scale</span> = <span class="cm-variable">cat_scaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">cat_tfdid_svd</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_tfdid_svd</span> = <span class="cm-variable">minmax_dog_scale</span>.<span class="cm-property">transform</span>(<span class="cm-variable">dog_tfdid_svd</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_tfdid_svd</span> = <span class="cm-variable">minmax_cat_scale</span>.<span class="cm-property">transform</span>(<span class="cm-variable">cat_tfdid_svd</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_train</span> = <span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>].<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_dog_train</span>, <span class="cm-variable">dog_tfdid_svd</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_cat_train</span> = <span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>].<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_cat_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_cat_train</span>, <span class="cm-variable">cat_tfdid_svd</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_train</span> = <span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>].<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_cat_train</span> = <span class="cm-variable">df_train</span>[<span class="cm-variable">df_train</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>].<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">vstack</span>((<span class="cm-variable">X_dog_train</span>, <span class="cm-variable">X_cat_train</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_train</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">y_dog_train</span>, <span class="cm-variable">y_cat_train</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># perform transformations on test data</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_text_features_test</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>] .<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_text_features_test</span> = <span class="cm-variable">tfv_d</span>.<span class="cm-property">transform</span>(<span class="cm-variable">dog_text_features_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_text_features_test</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>] .<span class="cm-property">apply</span>(<span class="cm-keyword">lambda</span> <span class="cm-variable">x</span>: <span class="cm-string">'%s %s'</span> <span class="cm-operator">%</span> (<span class="cm-variable">x</span>[<span class="cm-string">'Breed'</span>], <span class="cm-variable">x</span>[<span class="cm-string">'Color'</span>]),<span class="cm-variable">axis</span>=<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_text_features_test</span> = <span class="cm-variable">tfv_c</span>.<span class="cm-property">transform</span>(<span class="cm-variable">cat_text_features_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_tfdid_svd_test</span> = <span class="cm-variable">dog_svd</span>.<span class="cm-property">transform</span>(<span class="cm-variable">dog_text_features_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_tfdid_svd_test</span> = <span class="cm-variable">cat_svd</span>.<span class="cm-property">transform</span>(<span class="cm-variable">cat_text_features_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">dog_tfdid_svd_test</span> = <span class="cm-variable">minmax_dog_scale</span>.<span class="cm-property">transform</span>(<span class="cm-variable">dog_tfdid_svd_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cat_tfdid_svd_test</span> = <span class="cm-variable">minmax_cat_scale</span>.<span class="cm-property">transform</span>(<span class="cm-variable">cat_tfdid_svd_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_test</span> = <span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>].<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_dog_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_dog_test</span>, <span class="cm-variable">dog_tfdid_svd_test</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_cat_test</span> = <span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>].<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_cat_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">X_cat_test</span>, <span class="cm-variable">cat_tfdid_svd_test</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_dog_test</span> = <span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">1</span>].<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_cat_test</span> = <span class="cm-variable">df_test</span>[<span class="cm-variable">df_test</span>.<span class="cm-property">AnimalType_Dog</span>==<span class="cm-number">0</span>].<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">vstack</span>((<span class="cm-variable">X_dog_test</span>, <span class="cm-variable">X_cat_test</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_test</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">y_dog_test</span>, <span class="cm-variable">y_cat_test</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># replace Euthanasia with Died - now we have one less class, grouping eventually-deceased animals in one class</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">reduce_to_binary</span> = <span class="cm-builtin">False</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">if</span> (<span class="cm-variable">reduce_to_binary</span> == <span class="cm-builtin">True</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">y_train</span>[<span class="cm-variable">y_train</span> == <span class="cm-string">'Euthanasia'</span>] = <span class="cm-string">'Died'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">y_test</span>[<span class="cm-variable">y_test</span> == <span class="cm-string">'Euthanasia'</span>] = <span class="cm-string">'Died'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> [<span class="cm-string">'Adoption'</span>, <span class="cm-string">'Return_to_owner'</span>,<span class="cm-string">'Transfer'</span>]:    </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">y_train</span>[<span class="cm-variable">y_train</span>==<span class="cm-variable">i</span>] = <span class="cm-string">'Lives'</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">y_test</span>[<span class="cm-variable">y_test</span>==<span class="cm-variable">i</span>] = <span class="cm-string">'Lives'</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_train</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_test</span> = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">arrays</span> = [<span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-variable">x</span>.<span class="cm-property">shape</span> <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">arrays</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 1677px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1707px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>[(21368, 27), (5342, 27), (21368,), (5342,)]
</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 209.6px; left: 205.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 707px; margin-bottom: -10px; border-right-width: 20px; min-height: 555px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 200px; top: 204px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># create simple set, ignoring breed/colour attributes</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># create feature and label array (when not using tfidx features)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X</span> = <span class="cm-variable">df</span>.<span class="cm-property">loc</span>[:, <span class="cm-variable">model_columns</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#X = StandardScaler(with_mean=False).fit_transform(X)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y</span> = <span class="cm-variable">np</span>.<span class="cm-property">copy</span>(<span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">df</span>.<span class="cm-property">iloc</span>[:, <span class="cm-number">3</span>].<span class="cm-property">values</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">reduce_to_binary</span> = <span class="cm-builtin">False</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">if</span> (<span class="cm-variable">reduce_to_binary</span> == <span class="cm-builtin">True</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">y</span>[<span class="cm-variable">y</span> == <span class="cm-string">'Euthanasia'</span>] = <span class="cm-string">'Died'</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> [<span class="cm-string">'Adoption'</span>, <span class="cm-string">'Return_to_owner'</span>,<span class="cm-string">'Transfer'</span>]:    </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">y</span>[<span class="cm-variable">y</span>==<span class="cm-variable">i</span>] = <span class="cm-string">'Lives'</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># we can compute inverse_transform to get back the labels</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># le.inverse_transform(y)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">le</span> = <span class="cm-variable">LabelEncoder</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y</span>  = <span class="cm-variable">le</span>.<span class="cm-property">fit_transform</span>(<span class="cm-variable">y</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># split in training and testing sets</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span> = <span class="cm-variable">train_test_split</span>(<span class="cm-variable">X</span>, <span class="cm-variable">y</span>, <span class="cm-variable">test_size</span>=<span class="cm-number">0.2</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">2</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">unique</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">unique</span>(<span class="cm-variable">y_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># convert target variable to number</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">arrays</span> = [<span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-variable">x</span>.<span class="cm-property">shape</span> <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">arrays</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 555px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 347px; margin-bottom: -10px; border-right-width: 20px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">unique</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">unique</span>(<span class="cm-variable">y_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">arrays</span> = [<span class="cm-variable">X_train</span>, <span class="cm-variable">X_test</span>, <span class="cm-variable">y_train</span>, <span class="cm-variable">y_test</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-variable">x</span>.<span class="cm-property">shape</span> <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">arrays</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 116px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60004px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">-</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 707px; margin-bottom: -10px; border-right-width: 20px; min-height: 538px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 510px; width: 544px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 984px; height: 493px;"></div></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># plot terms by weight and component</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">plot_weighted_terms_by_component</span>(<span class="cm-variable">svd</span>, <span class="cm-variable">feat_names</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">for</span> <span class="cm-variable">compNum</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-number">10</span>):</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">comp</span> = <span class="cm-variable">svd</span>.<span class="cm-property">components_</span>[<span class="cm-variable">compNum</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># Sort the weights in the first component, and get the indeces</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">indices</span> = <span class="cm-variable">np</span>.<span class="cm-property">argsort</span>(<span class="cm-variable">comp</span>).<span class="cm-property">tolist</span>()</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment">#print len(indices)</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># Reverse the indeces, so we have the largest weights first.</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">indices</span>.<span class="cm-property">reverse</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># Grab the top 10 terms which have the highest weight in this component.        </span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">terms</span> = [<span class="cm-variable">feat_names</span>[<span class="cm-variable">weightIndex</span>] <span class="cm-keyword">for</span> <span class="cm-variable">weightIndex</span> <span class="cm-keyword">in</span> <span class="cm-variable">indices</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]]    </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">weights</span> = [<span class="cm-variable">comp</span>[<span class="cm-variable">weightIndex</span>] <span class="cm-keyword">for</span> <span class="cm-variable">weightIndex</span> <span class="cm-keyword">in</span> <span class="cm-variable">indices</span>[<span class="cm-number">0</span>:<span class="cm-number">10</span>]]    </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># Display these terms and their weights as a horizontal bar graph.    </span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># The horizontal bar graph displays the first item on the bottom; reverse</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-comment"># the order of the terms so the biggest one is on top.</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">terms</span>.<span class="cm-property">reverse</span>()</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">weights</span>.<span class="cm-property">reverse</span>()</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">positions</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-number">10</span>) <span class="cm-operator">+</span> <span class="cm-number">.5</span>    <span class="cm-comment"># the bar centers on the y axis</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">figure</span>(<span class="cm-variable">compNum</span>)</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">barh</span>(<span class="cm-variable">positions</span>, <span class="cm-variable">weights</span>, <span class="cm-variable">align</span>=<span class="cm-string">'center'</span>)</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">yticks</span>(<span class="cm-variable">positions</span>, <span class="cm-variable">terms</span>)</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">xlabel</span>(<span class="cm-string">'Weight'</span>)</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">title</span>(<span class="cm-string">'Strongest terms for component %d'</span> <span class="cm-operator">%</span> (<span class="cm-variable">compNum</span>))</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">grid</span>(<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plot_weighted_terms_by_component</span>(<span class="cm-variable">dog_svd</span>, <span class="cm-variable">tfv_d</span>.<span class="cm-property">get_feature_names</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 538px;"></div><div class="CodeMirror-gutters" style="display: none; height: 558px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[50]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 243.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 339px; margin-bottom: -10px; border-right-width: 20px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 238px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#print X_dog_train_lsa[:,:2]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print X_dog_train_lsa.shape</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print svd.components_[0].shape</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">##print svd.n_components</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print len(feat_names)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print svd.explained_variance_ratio_.sum()</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print breed_colour.shape</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print X_dog_train.shape</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print X_dog_train_lsa[1,:]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df_dog_train.iloc[:1,:]</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">dog_svd</span>.<span class="cm-property">explained_variance_</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>0.315857213887
</pre></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[50]:</div><div class="output_subarea output_text output_result"><pre>array([ 1.        ,  1.        ,  0.        ,  1.        ,  0.        ,
        0.        ,  1.        ,  0.        ,  0.        ,  0.        ,
        0.        ,  0.        ,  0.        ,  1.        ,  0.        ,
        0.        ,  0.        ,  0.17172945,  0.44201415,  0.46250432,
        0.25079033,  0.36919961,  0.49641539,  0.38395192,  0.29682812,
        0.3267557 ,  0.52594904])</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 124.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 619px; margin-bottom: -10px; border-right-width: 20px; min-height: 181px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 119px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#get_top_n_features((X_dog_train[y_dog_train==0])[:,17:])</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Check label proportions</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">collections</span> <span class="cm-keyword">import</span> <span class="cm-variable">Counter</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">_foo</span> = <span class="cm-variable">Counter</span>(<span class="cm-variable">y_test</span>), <span class="cm-variable">Counter</span>(<span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">_foo</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># confirm that propotion of test outcome is similar to population proportion</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-builtin">round</span>(<span class="cm-builtin">float</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">0</span>][<span class="cm-variable">x</span>]) <span class="cm-operator">/</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">0</span>].<span class="cm-property">values</span>()),<span class="cm-number">3</span>)   <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">_foo</span>[<span class="cm-number">0</span>]]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># confirm that propotion of train outcome is similar to population proportion</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> [<span class="cm-builtin">round</span>(<span class="cm-builtin">float</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">1</span>][<span class="cm-variable">x</span>]) <span class="cm-operator">/</span> <span class="cm-builtin">sum</span>(<span class="cm-variable">_foo</span>[<span class="cm-number">1</span>].<span class="cm-property">values</span>()),<span class="cm-number">3</span>)   <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-variable">_foo</span>[<span class="cm-number">1</span>]]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 181px;"></div><div class="CodeMirror-gutters" style="display: none; height: 201px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.6px; left: 285.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 467px; margin-bottom: -10px; border-right-width: 20px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 280px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Try oversampling prior to training model</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># oversample with SMOTE</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">imblearn</span>.<span class="cm-property">over_sampling</span> <span class="cm-keyword">import</span> <span class="cm-variable">SMOTE</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ratios</span> = {<span class="cm-number">0</span>:<span class="cm-number">8584</span>, <span class="cm-number">1</span>:<span class="cm-number">1000</span>, <span class="cm-number">2</span>:<span class="cm-number">2000</span>, <span class="cm-number">3</span>:<span class="cm-number">3846</span>, <span class="cm-number">4</span>:<span class="cm-number">7547</span>}</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#ratios = {0:3500, 1:19977}</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">sm</span> = <span class="cm-variable">SMOTE</span>(<span class="cm-variable">random_state</span>=<span class="cm-number">0</span>, <span class="cm-variable">ratio</span>=<span class="cm-variable">ratios</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_res</span>, <span class="cm-variable">y_train_res</span> = <span class="cm-variable">sm</span>.<span class="cm-property">fit_sample</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 150px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[55]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 229.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 531px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 224px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment"># train RF on dog breed/colour features </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">forest</span> = <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">n_estimators</span>=<span class="cm-number">1000</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">forest</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[55]:</div><div class="output_subarea output_text output_result"><pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',
            max_depth=None, max_features='auto', max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=1000, n_jobs=1,
            oob_score=False, random_state=0, verbose=0, warm_start=False)</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 1093.6px; left: 189.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">, full SVD</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 1252px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 184px; top: 1088px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span>RF using only dogs</span></pre><pre class=" CodeMirror-line "><span> </span></pre><pre class=" CodeMirror-line "><span>      <span class="cm-comment">precision    recall  f1-score   support</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       <span class="cm-comment">Adoption       0.60      0.72      0.65      1305</span></span></pre><pre class=" CodeMirror-line "><span>           <span class="cm-comment">Died       0.00      0.00      0.00        14</span></span></pre><pre class=" CodeMirror-line "><span>     <span class="cm-comment">Euthanasia       0.28      0.13      0.18       154</span></span></pre><pre class=" CodeMirror-line "><span>Return_to_owner       0.45      0.47      0.46       845</span></pre><pre class=" CodeMirror-line "><span>       Transfer       0.55      0.42      0.48       801</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    avg / total       0.53      0.54      0.53      3119</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span>Mixed RF (no oversampling)</span></pre><pre class=" CodeMirror-line "><span> precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       <span class="cm-comment">Adoption       0.68      0.75      0.71      2185</span></span></pre><pre class=" CodeMirror-line "><span>           <span class="cm-comment">Died       0.00      0.00      0.00        37</span></span></pre><pre class=" CodeMirror-line "><span>     <span class="cm-comment">Euthanasia       0.40      0.18      0.25       322</span></span></pre><pre class=" CodeMirror-line "><span>Return_to_owner       0.45      0.44      0.45       939</span></pre><pre class=" CodeMirror-line "><span>       Transfer       0.66      0.66      0.66      1859</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    avg / total       0.61      0.62      0.61      5342</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span>Mixed RF w. SMOTE (2000 estimators; balanced)</span></pre><pre class=" CodeMirror-line "><span>             precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       Adoption       0.68      0.74      0.71      2185</span></pre><pre class=" CodeMirror-line "><span>           Died       0.05      0.05      0.05        37</span></pre><pre class=" CodeMirror-line "><span>     Euthanasia       0.35      0.28      0.31       322</span></pre><pre class=" CodeMirror-line "><span>Return_to_owner       0.43      0.44      0.44       939</span></pre><pre class=" CodeMirror-line "><span>       Transfer       0.67      0.62      0.64      1859</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    avg / total       0.61      0.61      0.61      5342</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span>Mixed RF w. SMOTE (1000 estimators)</span></pre><pre class=" CodeMirror-line "><span>           precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       Adoption       0.68      0.75      0.71      2185</span></pre><pre class=" CodeMirror-line "><span>           Died       0.06      0.03      0.04        37</span></pre><pre class=" CodeMirror-line "><span>     Euthanasia       0.40      0.23      0.29       322</span></pre><pre class=" CodeMirror-line "><span>Return_to_owner       0.45      0.44      0.44       939</span></pre><pre class=" CodeMirror-line "><span>       Transfer       0.66      0.65      0.66      1859</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    avg / total       0.61      0.62      0.62      5342</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span>Mixef RF - collapse died/euthanasia into Died</span></pre><pre class=" CodeMirror-line "><span> precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       <span class="cm-comment">Adoption       0.68      0.75      0.71      2185</span></span></pre><pre class=" CodeMirror-line "><span>           <span class="cm-comment">Died       0.39      0.17      0.24       359</span></span></pre><pre class=" CodeMirror-line "><span>Return_to_owner       0.45      0.45      0.45       939</span></pre><pre class=" CodeMirror-line "><span>       Transfer       0.66      0.65      0.65      1859</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>    avg / total       0.61      0.62      0.61      5342</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span>Mixed RF - lives/dies</span></pre><pre class=" CodeMirror-line "><span>precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       <span class="cm-comment">Died       0.44      0.13      0.21       359</span></span></pre><pre class=" CodeMirror-line "><span>      <span class="cm-comment">Lives       0.94      0.99      0.96      4983</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>avg / total       0.91      0.93      0.91      5342</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>Lives vs Dies, full SVD with oversampling</span></pre><pre class=" CodeMirror-line "><span> precision    recall  f1-score   support</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>       <span class="cm-comment">Died       0.45      0.21      0.29       359</span></span></pre><pre class=" CodeMirror-line "><span>      <span class="cm-comment">Lives       0.95      0.98      0.96      4983</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>avg / total       0.91      0.93      0.92      5342</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 1252px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1272px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><pre><code>precision    recall  f1-score   support

   Adoption       0.60      0.72      0.65      1305
       Died       0.00      0.00      0.00        14
 Euthanasia       0.28      0.13      0.18       154
</code></pre><p>Return_to_owner       0.45      0.47      0.46       845
       Transfer       0.55      0.42      0.48       801</p>
<pre><code>avg / total       0.53      0.54      0.53      3119
</code></pre></div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[56]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 124.6px; left: 597.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">print(classification_report(y_test, prediction, target_names=le.classes_))</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595px; margin-bottom: -10px; border-right-width: 20px; min-height: 334px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 119px; width: 592px; height: 17px;"></div></div><div class="CodeMirror-cursors" style=""></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># predict outcome based on test dogs</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction</span> = <span class="cm-variable">forest</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction_proba</span> = <span class="cm-variable">forest</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">importances</span> = <span class="cm-variable">forest</span>.<span class="cm-property">feature_importances_</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">indices</span> = <span class="cm-variable">np</span>.<span class="cm-property">argsort</span>(<span class="cm-variable">importances</span>)[::<span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span>(<span class="cm-variable">classification_report</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>, <span class="cm-variable">target_names</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cnm</span> = <span class="cm-variable">confusion_matrix</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">figure</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plot_confusion_matrix</span>(<span class="cm-variable">cnm</span>, <span class="cm-variable">classes</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">title</span>=<span class="cm-string">'Confusion matrix, without normalization'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">close</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">log_loss</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction_proba</span> )</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 334px;"></div><div class="CodeMirror-gutters" style="display: none; height: 354px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>                 precision    recall  f1-score   support

       Adoption       0.68      0.75      0.71      2185
           Died       0.00      0.00      0.00        37
     Euthanasia       0.40      0.18      0.25       322
Return_to_owner       0.45      0.44      0.44       939
       Transfer       0.66      0.65      0.66      1859

    avg / total       0.61      0.62      0.61      5342

Confusion matrix, without normalization
[[1641    2    8  263  271]
 [   1    0    1    1   34]
 [  43    2   57   65  155]
 [ 329    0   28  414  168]
 [ 415    3   47  182 1212]]
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,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
gP8H08fYiCjYIWQAAAAASUVORK5CYII=
"></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[56]:</div><div class="output_subarea output_text output_result"><pre>1.163955152207333</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.6px; left: 149.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">4</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 771px; margin-bottom: -10px; border-right-width: 20px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 144px; top: 85px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">importances</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print np.sum(importances[:15])</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">indices</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ext_model_columns</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">model_columns</span>, <span class="cm-variable">np</span>.<span class="cm-property">asarray</span>([<span class="cm-string">"SVD_"</span> <span class="cm-operator">+</span> <span class="cm-builtin">str</span>(<span class="cm-variable">x</span>) <span class="cm-keyword">for</span> <span class="cm-variable">x</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">2</span>)]))) </span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#ext_model_columns = model_columns</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">feature_count</span> = <span class="cm-number">14</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plot_feature_importance</span>(<span class="cm-variable">importances</span>, <span class="cm-variable">indices</span>, <span class="cm-variable">feature_count</span>, <span class="cm-variable">ext_model_columns</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print model_columns</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#np.max(X_train[:,18:])</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 133.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">000</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 259px; margin-bottom: -10px; border-right-width: 20px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 128px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-comment">#ext_model_columns[indices][:15]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_res</span>[<span class="cm-number">1000</span>,]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 65px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.6px; left: 197.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 403px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 192px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">neighbors</span> <span class="cm-keyword">import</span> <span class="cm-variable">KNeighborsClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">knn</span> = <span class="cm-variable">KNeighborsClassifier</span>(<span class="cm-number">5</span>, <span class="cm-variable">metric</span>=<span class="cm-string">'jaccard'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">knn</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.6px; left: 93.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595px; margin-bottom: -10px; border-right-width: 20px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 88px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction</span> = <span class="cm-variable">knn</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span>(<span class="cm-variable">classification_report</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>, <span class="cm-variable">target_names</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cnm</span> = <span class="cm-variable">confusion_matrix</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">figure</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plot_confusion_matrix</span>(<span class="cm-variable">cnm</span>, <span class="cm-variable">classes</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">title</span>=<span class="cm-string">'Confusion matrix, without normalization'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">close</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 235px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[51]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.6px; left: 117.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 859px; margin-bottom: -10px; border-right-width: 20px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 112px; top: 68px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span> = <span class="cm-variable">LogisticRegression</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#lr = LogisticRegression(penalty='l2', C=10**-1, random_state=0, multi_class='multinomial', solver='lbfgs')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#rfecv = RFECV(estimator=lr, step=1, cv=StratifiedKFold(y_train, n_folds=5), scoring='accuracy')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#rfecv.fit(X_train, y_train)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 116px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[51]:</div><div class="output_subarea output_text output_result"><pre>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,
          penalty='l2', random_state=None, solver='liblinear', tol=0.0001,
          verbose=0, warm_start=False)</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 349.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 363px; margin-bottom: -10px; border-right-width: 20px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 344px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_best</span> = <span class="cm-variable">X_train</span>[:,[<span class="cm-number">3</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>,  <span class="cm-number">1</span>,  <span class="cm-number">0</span>]]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_test_best</span> = <span class="cm-variable">X_test</span>[:,[<span class="cm-number">3</span>, <span class="cm-number">12</span>, <span class="cm-number">13</span>,  <span class="cm-number">1</span>,  <span class="cm-number">0</span>]]</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 65px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[54]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.6px; left: 85.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 595px; margin-bottom: -10px; border-right-width: 20px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 80px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction</span> = <span class="cm-variable">lr</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">prediction_proba</span> = <span class="cm-variable">lr</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span>(<span class="cm-variable">classification_report</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>, <span class="cm-variable">target_names</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">cnm</span> = <span class="cm-variable">confusion_matrix</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">figure</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plot_confusion_matrix</span>(<span class="cm-variable">cnm</span>, <span class="cm-variable">classes</span>=<span class="cm-variable">le</span>.<span class="cm-property">classes_</span>,</span></pre><pre class=" CodeMirror-line "><span>                      <span class="cm-variable">title</span>=<span class="cm-string">'Confusion matrix, without normalization'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">close</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">log_loss</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">prediction_proba</span> )</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>                 precision    recall  f1-score   support

       Adoption       0.66      0.85      0.74      2185
           Died       0.00      0.00      0.00        37
     Euthanasia       0.61      0.04      0.08       322
Return_to_owner       0.46      0.40      0.43       939
       Transfer       0.70      0.64      0.67      1859

    avg / total       0.63      0.64      0.62      5342

Confusion matrix, without normalization
[[1849    0    0  223  113]
 [   0    0    0    2   35]
 [  41    0   14   69  198]
 [ 404    0    1  378  156]
 [ 506    0    8  153 1192]]
</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text"><pre>&lt;matplotlib.figure.Figure at 0x7f69eb0f9b10&gt;</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,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
"></div></div><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[54]:</div><div class="output_subarea output_text output_result"><pre>0.86232364385682314</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell unrendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60004px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Train Ensemble of Logistic Regressors</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Train-Ensemble-of-Logistic-Regressors">Train Ensemble of Logistic Regressors<a class="anchor-link" href="#Train-Ensemble-of-Logistic-Regressors">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 10px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="display: block; right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 1347px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true" style="height: 10px; width: 10px;"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 1347px; margin-bottom: -10px; border-right-width: 20px; min-height: 1014px; padding-right: 0px; padding-bottom: 10px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># taken from http://scikit-learn.org/stable/auto_examples/multioutput/plot_classifier_chain_yeast.html#sphx-glr-auto-examples-multioutput-plot-classifier-chain-yeast-py</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">multioutput</span> <span class="cm-keyword">import</span> <span class="cm-variable">ClassifierChain</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">multiclass</span> <span class="cm-keyword">import</span> <span class="cm-variable">OneVsRestClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">jaccard_similarity_score</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">linear_model</span> <span class="cm-keyword">import</span> <span class="cm-variable">LogisticRegression</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">datasets</span> <span class="cm-keyword">import</span> <span class="cm-variable">fetch_mldata</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#yeast = fetch_mldata('yeast')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#_X = yeast['data']</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#_Y = yeast['target'].transpose().toarray()</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Fit an independent logistic regression model for each class using the</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># OneVsRestClassifier wrapper.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ovr</span> = <span class="cm-variable">OneVsRestClassifier</span>(<span class="cm-variable">LogisticRegression</span>())</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ovr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_pred_ovr</span> = <span class="cm-variable">ovr</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ovr_jaccard_score</span> = <span class="cm-variable">jaccard_similarity_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred_ovr</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Fit an ensemble of logistic regression classifier chains and take the</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># take the average prediction of all the chains.</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">chains</span> = [<span class="cm-variable">ClassifierChain</span>(<span class="cm-variable">LogisticRegression</span>(), <span class="cm-variable">order</span>=<span class="cm-string">'random'</span>, <span class="cm-variable">random_state</span>=<span class="cm-variable">i</span>)</span></pre><pre class=" CodeMirror-line "><span>          <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">10</span>)]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">chain</span> <span class="cm-keyword">in</span> <span class="cm-variable">chains</span>:</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">chain</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span>    </span></pre><pre class=" CodeMirror-line "><span> </span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable cm-error">y_pred_chains</span> = <span class="cm-variable">np</span>.<span class="cm-property">array</span>([<span class="cm-variable">chain</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>) <span class="cm-keyword">for</span> <span class="cm-variable">chain</span> <span class="cm-keyword">in</span> <span class="cm-variable">chains</span>])</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">chain_jaccard_scores</span> = [<span class="cm-variable">jaccard_similarity_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">y_pred_chain</span> <span class="cm-operator">&gt;</span>= <span class="cm-number">.5</span>)</span></pre><pre class=" CodeMirror-line "><span>                        <span class="cm-keyword">for</span> <span class="cm-variable">y_pred_chain</span> <span class="cm-keyword">in</span> <span class="cm-variable">y_pred_chains</span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">y_pred_ensemble</span> = <span class="cm-variable">y_pred_chains</span>.<span class="cm-property">mean</span>(<span class="cm-variable">axis</span>=<span class="cm-number">0</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ensemble_jaccard_score</span> = <span class="cm-variable">jaccard_similarity_score</span>(<span class="cm-variable">y_test</span>,</span></pre><pre class=" CodeMirror-line "><span>                                                  <span class="cm-variable">y_pred_ensemble</span> <span class="cm-operator">&gt;</span>= <span class="cm-number">.5</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">model_scores</span> = [<span class="cm-variable">ovr_jaccard_score</span>] <span class="cm-operator">+</span> <span class="cm-variable">chain_jaccard_scores</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">model_scores</span>.<span class="cm-property">append</span>(<span class="cm-variable">ensemble_jaccard_score</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">model_names</span> = (<span class="cm-string">'Independent'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 1'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 2'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 3'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 4'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 5'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 6'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 7'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 8'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 9'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Chain 10'</span>,</span></pre><pre class=" CodeMirror-line "><span>               <span class="cm-string">'Ensemble'</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">model_scores</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">x_pos</span> = <span class="cm-variable">np</span>.<span class="cm-property">arange</span>(<span class="cm-builtin">len</span>(<span class="cm-variable">model_names</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 10px solid transparent; top: 1014px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1044px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.60001px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 603px; margin-bottom: -10px; border-right-width: 20px; min-height: 283px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Plot the Jaccard similarity scores for the independent model, each of the</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># chains, and the ensemble (note that the vertical axis on this plot does</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># not begin at 0).</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">fig</span>, <span class="cm-variable">ax</span> = <span class="cm-variable">plt</span>.<span class="cm-property">subplots</span>(<span class="cm-variable">figsize</span>=(<span class="cm-number">7</span>, <span class="cm-number">4</span>))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">grid</span>(<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">set_title</span>(<span class="cm-string">'Classifier Chain Ensemble Performance Comparison'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">set_xticks</span>(<span class="cm-variable">x_pos</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">set_xticklabels</span>(<span class="cm-variable">model_names</span>, <span class="cm-variable">rotation</span>=<span class="cm-string">'vertical'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">set_ylabel</span>(<span class="cm-string">'Jaccard Similarity Score'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">set_ylim</span>([<span class="cm-builtin">min</span>(<span class="cm-variable">model_scores</span>) <span class="cm-operator">*</span> <span class="cm-number">.9</span>, <span class="cm-builtin">max</span>(<span class="cm-variable">model_scores</span>) <span class="cm-operator">*</span> <span class="cm-number">1.1</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">colors</span> = [<span class="cm-string">'r'</span>] <span class="cm-operator">+</span> [<span class="cm-string">'b'</span>] <span class="cm-operator">*</span> <span class="cm-builtin">len</span>(<span class="cm-variable">chain_jaccard_scores</span>) <span class="cm-operator">+</span> [<span class="cm-string">'g'</span>]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span>.<span class="cm-property">bar</span>(<span class="cm-variable">x_pos</span>, <span class="cm-variable">model_scores</span>, <span class="cm-variable">alpha</span>=<span class="cm-number">0.5</span>, <span class="cm-variable">color</span>=<span class="cm-variable">colors</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">tight_layout</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()    </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 283px;"></div><div class="CodeMirror-gutters" style="display: none; height: 303px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59961px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; padding-right: 0px; padding-bottom: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Test a bunch of classifiers</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Test-a-bunch-of-classifiers">Test a bunch of classifiers<a class="anchor-link" href="#Test-a-bunch-of-classifiers">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 889.6px; left: 325.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">est</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 571px; margin-bottom: -10px; border-right-width: 20px; min-height: 946px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 320px; top: 884px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># Code source: Gaël Varoquaux</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#              Andreas Müller</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># Modified for documentation by Jaques Grobler</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># License: BSD 3 clause</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">matplotlib</span>.<span class="cm-property">colors</span> <span class="cm-keyword">import</span> <span class="cm-variable">ListedColormap</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">model_selection</span> <span class="cm-keyword">import</span> <span class="cm-variable">train_test_split</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">StandardScaler</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">neural_network</span> <span class="cm-keyword">import</span> <span class="cm-variable">MLPClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">neighbors</span> <span class="cm-keyword">import</span> <span class="cm-variable">KNeighborsClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">svm</span> <span class="cm-keyword">import</span> <span class="cm-variable">SVC</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">gaussian_process</span> <span class="cm-keyword">import</span> <span class="cm-variable">GaussianProcessClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">gaussian_process</span>.<span class="cm-property">kernels</span> <span class="cm-keyword">import</span> <span class="cm-variable">RBF</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">tree</span> <span class="cm-keyword">import</span> <span class="cm-variable">DecisionTreeClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">ensemble</span> <span class="cm-keyword">import</span> <span class="cm-variable">RandomForestClassifier</span>, <span class="cm-variable">AdaBoostClassifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">naive_bayes</span> <span class="cm-keyword">import</span> <span class="cm-variable">GaussianNB</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">discriminant_analysis</span> <span class="cm-keyword">import</span> <span class="cm-variable">QuadraticDiscriminantAnalysis</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#h = .02  # step size in the mesh</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">names</span> = [<span class="cm-string">"Nearest Neighbors"</span>, </span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-string">"Linear SVM"</span>, </span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-comment">#"RBF SVM", </span></span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-comment">#"Gaussian Process",</span></span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-string">"Decision Tree"</span>, <span class="cm-string">"Random Forest"</span>,</span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-string">"Neural Net"</span>, <span class="cm-string">"AdaBoost"</span>,</span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-string">"Naive Bayes"</span></span></pre><pre class=" CodeMirror-line "><span>         <span class="cm-comment">#, "QDA"]</span></span></pre><pre class=" CodeMirror-line "><span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">classifiers</span> = [</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">KNeighborsClassifier</span>(<span class="cm-number">3</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">SVC</span>(<span class="cm-variable">kernel</span>=<span class="cm-string">"linear"</span>, <span class="cm-variable">C</span>=<span class="cm-number">0.025</span>, <span class="cm-variable">probability</span>=<span class="cm-builtin">True</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#SVC(gamma=2, C=1),</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#GaussianProcessClassifier(1.0 * RBF(1.0)),</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">DecisionTreeClassifier</span>(),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">n_estimators</span>=<span class="cm-number">100</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">MLPClassifier</span>(<span class="cm-variable">alpha</span>=<span class="cm-number">1</span>),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">AdaBoostClassifier</span>(),</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">GaussianNB</span>()</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#QuadraticDiscriminantAnalysis()]</span></span></pre><pre class=" CodeMirror-line "><span>]</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">scores</span>=[]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># iterate over classifiers</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">name</span>, <span class="cm-variable">clf</span> <span class="cm-keyword">in</span> <span class="cm-builtin">zip</span>(<span class="cm-variable">names</span>, <span class="cm-variable">classifiers</span>):    </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span> <span class="cm-string">"Doing %s"</span> <span class="cm-operator">%</span> (<span class="cm-variable">name</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train_best</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#score = clf.score(X_test, y_test)</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#scores.append(score)</span></span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">pred</span> = <span class="cm-variable">clf</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test_best</span>)     </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">scores</span>.<span class="cm-property">append</span>(<span class="cm-variable">log_loss</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">pred</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 946px;"></div><div class="CodeMirror-gutters" style="display: none; height: 966px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 301.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 411px; margin-bottom: -10px; border-right-width: 20px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 296px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">scores</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#classifiers[2].fit(X_train, y_train)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#predictions = classifiers[2].predict_proba(X_test)</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 82px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 73.6px; left: 469.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"># oversample with SMOTE
from imblearn.over_sampling import SMOTE
ratios = {0:8584, 1:3000, 2:3000, 3:4000, 4:8000}
sm = SMOTE(random_state=0, ratio=ratios)
X_train_res, y_train_res = sm.fit_sample(X_train, y_train)</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 467px; margin-bottom: -10px; border-right-width: 20px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 0px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 68px; width: 464px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 984px; height: 51px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># oversample with SMOTE</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">imblearn</span>.<span class="cm-property">over_sampling</span> <span class="cm-keyword">import</span> <span class="cm-variable">SMOTE</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ratios</span> = {<span class="cm-number">0</span>:<span class="cm-number">8584</span>, <span class="cm-number">1</span>:<span class="cm-number">3000</span>, <span class="cm-number">2</span>:<span class="cm-number">3000</span>, <span class="cm-number">3</span>:<span class="cm-number">4000</span>, <span class="cm-number">4</span>:<span class="cm-number">8000</span>}</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">sm</span> = <span class="cm-variable">SMOTE</span>(<span class="cm-variable">random_state</span>=<span class="cm-number">0</span>, <span class="cm-variable">ratio</span>=<span class="cm-variable">ratios</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">X_train_res</span>, <span class="cm-variable">y_train_res</span> = <span class="cm-variable">sm</span>.<span class="cm-property">fit_sample</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 116px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.6px; left: 197.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">lr = LogisticRegression()
#rfecv = RFECV(estimator=lr, step=1, cv=StratifiedKFold(y_train, n_folds=5), scoring='accuracy')
#rfecv.fit(X_train, y_train)
lr.fit(X_train, y_train)</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 859px; margin-bottom: -10px; border-right-width: 20px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 34px; width: 984px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 85px; width: 192px; height: 17px;"></div><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 51px; width: 984px; height: 34px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># perform recursive feature elimination using stratified K fold cross validation</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#lr = LogisticRegression(penalty='l2', C=10**-1, random_state=0, multi_class='multinomial', solver='lbfgs')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span> = <span class="cm-variable">LogisticRegression</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#rfecv = RFECV(estimator=lr, step=1, cv=StratifiedKFold(y_train, n_folds=5), scoring='accuracy')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#rfecv.fit(X_train, y_train)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 133px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 283px; margin-bottom: -10px; border-right-width: 20px; min-height: 113px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 51px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#rfecv.grid_scores_</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#model_columns[rfecv.ranking_ == 1]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># use all features for now</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">predictions</span> = <span class="cm-variable">lr</span>.<span class="cm-property">predict</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 113px;"></div><div class="CodeMirror-gutters" style="display: none; height: 133px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.6px; left: 325.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">5</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 755px; margin-bottom: -10px; border-right-width: 20px; min-height: 470px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 320px; top: 85px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># try and optimise regularisation parameter C (inverse of lambda)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># return log loss for various regularisation C values over stratified folds</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">def</span> <span class="cm-def">score</span>(<span class="cm-variable">clf</span>, <span class="cm-variable">random_state</span> = <span class="cm-number">0</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">kf</span> = <span class="cm-variable">StratifiedKFold</span>(<span class="cm-variable">y_train</span>, <span class="cm-variable">n_folds</span>=<span class="cm-number">5</span>, <span class="cm-variable">shuffle</span>=<span class="cm-builtin">True</span>, <span class="cm-variable">random_state</span>=<span class="cm-variable">random_state</span>)</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">pred</span> = <span class="cm-variable">np</span>.<span class="cm-property">zeros</span>((<span class="cm-variable">y_train</span>.<span class="cm-property">shape</span>[<span class="cm-number">0</span>], <span class="cm-number">5</span>))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">score</span>=[]</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">for</span> <span class="cm-variable">train</span>, <span class="cm-variable">test</span> <span class="cm-keyword">in</span> <span class="cm-variable">kf</span>:</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">X_train_tr</span>, <span class="cm-variable">X_train_test</span> = <span class="cm-variable">X_train</span>[<span class="cm-variable">train</span>, :], <span class="cm-variable">X_train</span>[<span class="cm-variable">test</span>, :]</span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">y_train_tr</span>, <span class="cm-variable">y_train_test</span> = <span class="cm-variable">y_train</span>[<span class="cm-variable">train</span>], <span class="cm-variable">y_train</span>[<span class="cm-variable">test</span>]        </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">clf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train_tr</span>, <span class="cm-variable">y_train_tr</span>)        </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">pred</span>[<span class="cm-variable">test</span>,:] = <span class="cm-variable">clf</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_train_test</span>)     </span></pre><pre class=" CodeMirror-line "><span>        <span class="cm-variable">score</span>.<span class="cm-property">append</span>(<span class="cm-variable">log_loss</span>(<span class="cm-variable">y_train_test</span>, <span class="cm-variable">pred</span>[<span class="cm-variable">test</span>, :]))        </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">print</span> <span class="cm-string">'Log loss: %.3f'</span> <span class="cm-operator">%</span> (<span class="cm-variable">log_loss</span>(<span class="cm-variable">y_train</span>, <span class="cm-variable">pred</span>))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-keyword">return</span> <span class="cm-variable">score</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">Cs</span> = <span class="cm-variable">np</span>.<span class="cm-property">logspace</span>(<span class="cm-operator">-</span><span class="cm-number">3</span>,<span class="cm-number">0</span>,<span class="cm-number">4</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#Cs = np.arange(-5, 5)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">res</span> = []</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">c</span> <span class="cm-keyword">in</span> <span class="cm-variable">Cs</span>:</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">res</span>.<span class="cm-property">append</span>(<span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">score</span>(<span class="cm-variable">LogisticRegression</span>(<span class="cm-variable">penalty</span>=<span class="cm-string">'l1'</span>, <span class="cm-variable">C</span> = <span class="cm-variable">c</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">0</span>))))</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-comment">#res.append(np.mean(score(LogisticRegression(penalty='l2', C = c, random_state=0, </span></span></pre><pre class=" CodeMirror-line "><span>     <span class="cm-comment">#                                           multi_class='multinomial', solver='lbfgs'))))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">semilogx</span>(<span class="cm-variable">Cs</span>, <span class="cm-variable">res</span>,<span class="cm-string">'-b'</span>);</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#plt.plot(Cs, res, '-b')</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 470px;"></div><div class="CodeMirror-gutters" style="display: none; height: 490px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.6px; left: 853.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">lr = LogisticRegression(penalty='l2', C=10**-1, random_state=0, multi_class='multinomial', solver='lbfgs')</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 851px; margin-bottom: -10px; border-right-width: 20px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"><div class="CodeMirror-selected" style="position: absolute; left: 0px; top: 17px; width: 848px; height: 17px;"></div></div><div class="CodeMirror-cursors" style="visibility: hidden;"></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># run one-vs all logistic regression classifier</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span> = <span class="cm-variable">LogisticRegression</span>(<span class="cm-variable">penalty</span>=<span class="cm-string">'l2'</span>, <span class="cm-variable">C</span>=<span class="cm-number">10</span><span class="cm-operator">**-</span><span class="cm-number">1</span>, <span class="cm-variable">random_state</span>=<span class="cm-number">0</span>, <span class="cm-variable">multi_class</span>=<span class="cm-string">'multinomial'</span>, <span class="cm-variable">solver</span>=<span class="cm-string">'lbfgs'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">lr</span>.<span class="cm-property">fit</span>(<span class="cm-variable">X_train_res</span>, <span class="cm-variable">y_train_res</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print X_test[0,:].reshape(-1,12)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">predictions</span> = <span class="cm-variable">lr</span>.<span class="cm-property">predict_proba</span>(<span class="cm-variable">X_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">predictions</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#lr.predict_proba(X_test[0,:].reshape(-1,12))</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">lr</span>.<span class="cm-property">score</span>(<span class="cm-variable">X_train</span>, <span class="cm-variable">y_train</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">lr</span>.<span class="cm-property">score</span>(<span class="cm-variable">X_test</span>, <span class="cm-variable">y_test</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 235px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="display: none;" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style="display: none;"></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59999px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 883px; margin-bottom: -10px; border-right-width: 20px; min-height: 487px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment"># model beats the null model (whereby most frequent class is selected all the time).  This sort of model would</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># be correct 41% of the time</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># calculate accuracy score manually</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">result_array</span> = <span class="cm-variable">np</span>.<span class="cm-property">hstack</span>((<span class="cm-variable">y_test</span>.<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>), <span class="cm-variable">predictions</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">axis</span> = <span class="cm-number">1</span>).<span class="cm-property">reshape</span>(<span class="cm-operator">-</span><span class="cm-number">1</span>,<span class="cm-number">1</span>)))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-string">"Classifier accuracy: %.3f"</span> <span class="cm-operator">%</span> <span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">np</span>.<span class="cm-property">where</span>((<span class="cm-variable">result_array</span>[:,<span class="cm-number">0</span>]==<span class="cm-variable">result_array</span>[:,<span class="cm-number">1</span>]) == <span class="cm-builtin">True</span>, <span class="cm-number">1</span>, <span class="cm-number">0</span>))</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print recall_score(y_test, predictions)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># now i'd like to see which class was best predicted</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># results in first column represent the target label classes</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># find which class is worst predicted</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">class_distribution</span> = []</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">5</span>):</span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">temp</span> = <span class="cm-variable">result_array</span>[<span class="cm-variable">result_array</span>[:,<span class="cm-number">0</span>] == <span class="cm-variable">i</span>,:]     </span></pre><pre class=" CodeMirror-line "><span>    <span class="cm-variable">class_distribution</span>.<span class="cm-property">append</span>( <span class="cm-variable">np</span>.<span class="cm-property">mean</span>(<span class="cm-variable">np</span>.<span class="cm-property">where</span>((<span class="cm-variable">temp</span>[:,<span class="cm-number">0</span>] == <span class="cm-variable">temp</span>[:,<span class="cm-number">1</span>]), <span class="cm-number">1</span>, <span class="cm-number">0</span>)) )</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-string">"Classes: %s"</span> <span class="cm-operator">%</span> <span class="cm-variable">le</span>.<span class="cm-property">classes_</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-string">"Class accuracy: %s"</span> <span class="cm-operator">%</span> <span class="cm-variable">class_distribution</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment"># [0.409, 0.007, 0.06, 0.176, 0.348]</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span>                   </span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-string">"Classifier log loss: %s"</span> <span class="cm-operator">%</span>  <span class="cm-variable">log_loss</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">predictions</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-string">"Recall %.4f"</span> <span class="cm-operator">%</span> <span class="cm-variable">recall_score</span>(<span class="cm-variable">y_test</span>, <span class="cm-variable">predictions</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">axis</span> = <span class="cm-number">1</span>), <span class="cm-variable">average</span>=<span class="cm-string">'macro'</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print df.columns[9:]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print le.classes_</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 487px;"></div><div class="CodeMirror-gutters" style="display: none; height: 507px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59998px; left: 136.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: -10px; border-right-width: 20px; min-height: 34px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 131px; top: 0px; height: 23px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span><span class="cm-header cm-header-1"># Imbarazz</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 34px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h1 id="Imbarazz">Imbarazz<a class="anchor-link" href="#Imbarazz">¶</a></h1>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59999px; left: 197.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off">0</textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 395px; margin-bottom: -10px; border-right-width: 20px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 192px; top: 0px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-variable">x</span> = <span class="cm-variable">np</span>.<span class="cm-property">random</span>.<span class="cm-property">randn</span>(<span class="cm-number">1000</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">fig</span> = <span class="cm-variable">plt</span>.<span class="cm-property">figure</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">ax</span> = <span class="cm-variable">fig</span>.<span class="cm-property">add_subplot</span>(<span class="cm-number">111</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">n</span>, <span class="cm-variable">bins</span>, <span class="cm-variable">rectangles</span> = <span class="cm-variable">ax</span>.<span class="cm-property">hist</span>(<span class="cm-variable">x</span>, <span class="cm-number">50</span>, <span class="cm-variable">normed</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">fig</span>.<span class="cm-property">canvas</span>.<span class="cm-property">draw</span>()</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">plt</span>.<span class="cm-property">show</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 150px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[&nbsp;]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 311.6px; left: 61.6px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style="right: 0px; left: 0px;"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 715px; margin-bottom: -10px; border-right-width: 20px; min-height: 351px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 56px; top: 306px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">argmax</span>(<span class="cm-variable">n</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print n[30]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print bins[29:31]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print len(n)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print len(bins)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">scipy</span> <span class="cm-keyword">import</span> <span class="cm-variable">stats</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#stats.norm.pdf(3, loc=0.0, scale=1.0)</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#stats.norm.pdf(np.linspace(-1, 1), loc=0.0, scale=1.0)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print 1- stats.norm.cdf(-1, loc=0, scale=1.)  - (1- stats.norm.cdf(1, loc=0, scale=1.) )</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print stats.norm.cdf(-1, loc=0, scale=1.)  </span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#- stats.norm.cdf(1, loc=0, scale=1.)</span></span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print bins[1:]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#print bins[:-1]</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">np</span>.<span class="cm-property">sum</span>(<span class="cm-variable">n</span> <span class="cm-operator">*</span> (<span class="cm-variable">bins</span>[<span class="cm-number">1</span>:] <span class="cm-operator">-</span>  <span class="cm-variable">bins</span>[:<span class="cm-operator">-</span><span class="cm-number">1</span>]))</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">n</span> <span class="cm-operator">*</span> (<span class="cm-variable">bins</span>[<span class="cm-number">1</span>:] <span class="cm-operator">-</span>  <span class="cm-variable">bins</span>[:<span class="cm-operator">-</span><span class="cm-number">1</span>])</span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">n</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">print</span> <span class="cm-variable">bins</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 351px;"></div><div class="CodeMirror-gutters" style="display: none; height: 371px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt"><bdi>In</bdi>&nbsp;[57]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.6px; left: 5.60001px;"><textarea style="position: absolute; bottom: -1em; padding: 0px; width: 1px; height: 1em; outline: medium none currentcolor;" autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" wrap="off"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="true"><div class="CodeMirror-sizer" style="margin-left: 0px; min-width: 635px; margin-bottom: -10px; border-right-width: 20px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: medium none currentcolor;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 153px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span><span class="cm-comment">#minmax_scale = preprocessing.MinMaxScaler().fit(df[['Alcohol', 'Malic acid']])</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df_minmax = minmax_scale.transform(df[['Alcohol', 'Malic acid']])</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-property">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">MinMaxScaler</span> </span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">data</span> = [[<span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>], [<span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-number">0</span>, <span class="cm-number">0</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>]]</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">scaler</span> = <span class="cm-variable">MinMaxScaler</span>()</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">minmax_scale</span> = <span class="cm-variable">scaler</span>.<span class="cm-property">fit</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line "><span><span class="cm-variable">scaler</span>.<span class="cm-property">transform</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line "><span><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span><span class="cm-comment">#df_minmax = minmax_scale.transform(df[['Alcohol', 'Malic acid']])</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 20px; width: 1px; border-bottom: 0px solid transparent; top: 198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 218px;"></div></div></div></div></div></div><div class="output_wrapper"><div style="" class="out_prompt_overlay prompt" title="click to scroll output; double click to hide"></div><div class="output" style=""><div class="output_area"><div class="prompt output_prompt"><bdi>Out</bdi>[57]:</div><div class="output_subarea output_text output_result"><pre>array([[ 0.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],
       [ 0.,  1.,  1.,  0.,  0.,  0.,  0.,  0.]])</pre></div></div></div><div style="display: none;" class="btn btn-default output_collapsed" title="click to expand output">. . .</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"os_name": "posix", "platform": "Linux-4.10.0-37-generic-x86_64-with-Ubuntu-16.04-xenial", "default_encoding": "UTF-8", "notebook_path": "/usr/local/lib/python2.7/dist-packages/notebook", "sys_platform": "linux2", "sys_version": "2.7.12 (default, Nov 20 2017, 18:23:56) \n[GCC 5.4.0 20160609]", "notebook_version": "5.0.0", "commit_source": "", "commit_hash": "", "sys_executable": "/usr/bin/python"};
</script>

<script src="Animal%20Shelter_files/encoding.js" charset="utf-8"></script>

<script src="Animal%20Shelter_files/main.js" type="text/javascript" charset="utf-8"></script>



<script type="text/javascript">
  function _remove_token_from_url() {
    if (window.location.search.length <= 1) {
      return;
    }
    var search_parameters = window.location.search.slice(1).split('&');
    for (var i = 0; i < search_parameters.length; i++) {
      if (search_parameters[i].split('=')[0] === 'token') {
        // remote token from search parameters
        search_parameters.splice(i, 1);
        var new_search = '';
        if (search_parameters.length) {
          new_search = '?' + search_parameters.join('&');
        }
        var new_url = window.location.origin + 
                      window.location.pathname + 
                      new_search + 
                      window.location.hash;
        window.history.replaceState({}, "", new_url);
        return;
      }
    }
  }
  _remove_token_from_url();
</script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: STIXMathJax_Main, sans-serif;"></div></div></body></html>